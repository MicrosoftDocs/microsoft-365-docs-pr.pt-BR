---
title: Usar regras de fluxo de email para bloquear mensagens com anexos executáveis
f1.keywords:
- NOCSH
ms.author: chrisda
author: chrisda
manager: dansimp
ms.date: ''
audience: ITPro
ms.topic: how-to
ms.service: O365-seccomp
localization_priority: Normal
ms.assetid: c4fb4a86-b772-49d0-8773-e8ee897e175d
ms.custom:
- seo-marvel-apr2020
description: Os administradores podem aprender a criar regras de fluxo de emails (regras de transporte) para bloquear mensagens que contenham anexos executáveis.
ms.openlocfilehash: 4552cb76238ad995bab04a9ac50873bc22115ce4
ms.sourcegitcommit: ee39faf3507d0edc9497117b3b2854955c959c6c
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 12/10/2020
ms.locfileid: "49615907"
---
# <a name="use-mail-flow-rules-to-block-messages-with-executable-attachments-in-eop"></a>Usar regras de fluxo de email para bloquear mensagens com anexos executáveis no EOP

[!INCLUDE [Microsoft 365 Defender rebranding](../includes/microsoft-defender-for-office.md)]


Nas organizações do Microsoft 365 com caixas de correio em organizações do Exchange Online ou do Exchange Online Protection (EOP) sem caixas de correio do Exchange Online, o EOP usa políticas antimalware para bloquear mensagens perigosas, incluindo mensagens com anexos executáveis. Para obter mais informações, consulte [proteção Antimalware no EOP](anti-malware-protection.md).

Para aprimorar ainda mais a proteção, você pode usar regras de fluxo de emails (também conhecidas como regras de transporte) para identificar e bloquear mensagens que contenham anexos executáveis, conforme descrito neste tópico.

Por exemplo, seguindo uma epidemia de malware, uma empresa pode aplicar essa regra com um limite de tempo para que os usuários afetados possam voltar a enviar anexos após um período de tempo especificado.

## <a name="what-do-you-need-to-know-before-you-begin"></a>O que você precisa saber antes de começar?

- Você precisa ter permissões para poder executar estes procedimentos:

  - No Exchange Online, consulte o entrada "fluxo de email" em [permissões de recurso no Exchange Online](https://docs.microsoft.com/Exchange/permissions-exo/feature-permissions).

  - Em EOP autônomo, você precisa da função de regras de transporte, que é atribuída às funções gerenciamento, ComplianceManagement e RecordsManagement por padrão. Para obter mais informações, consulte [permissões em EOP autônomos](feature-permissions-in-eop.md) e [use o Eat modificar a lista de membros nos grupos de função](manage-admin-role-group-permissions-in-eop.md#use-the-eac-modify-the-list-of-members-in-role-groups).

- Para abrir o Eat no Exchange Online, confira [Exchange Admin Center in Exchange Online](https://docs.microsoft.com/Exchange/exchange-admin-center). Para abrir o Eat no EOP autônomo, confira [centro de administração do Exchange no EOP autônomo](exchange-admin-center-in-exchange-online-protection-eop.md).

- Para se conectar ao PowerShell do Exchange Online, confira [Conectar ao PowerShell do Exchange Online](https://docs.microsoft.com/powershell/exchange/connect-to-exchange-online-powershell). Para se conectar ao EOP PowerShell autônomo, consulte [Conectar-se ao PowerShell do Exchange Online Protection.](https://docs.microsoft.com/powershell/exchange/connect-to-exchange-online-protection-powershell).

- Para obter mais informações sobre regras de fluxo de emails no Exchange Online e EOP autônomos, consulte os seguintes tópicos:

  - [Regras de fluxo de emails (regras de transporte) no Exchange Online](https://docs.microsoft.com/Exchange/security-and-compliance/mail-flow-rules/mail-flow-rules)

  - [Condições e exceções de regra de fluxo de emails (predicados) no Exchange Online](https://docs.microsoft.com/Exchange/security-and-compliance/mail-flow-rules/conditions-and-exceptions)

  - [Ações de regra de fluxo de email no Exchange Online](https://docs.microsoft.com/Exchange/security-and-compliance/mail-flow-rules/mail-flow-rule-actions)

## <a name="use-the-eac-to-create-a-rule-that-blocks-messages-with-executable-attachments"></a>Use o Eat para criar uma regra que bloqueie mensagens com anexos executáveis

1. No EAC, vá para **Fluxo de emails** \> **Regras**.

2. Clique em **Adicionar** ![ ícone ](../../media/ITPro-EAC-AddIcon.png) de adição e selecione **criar uma nova regra**.

3. Na página **nova regra** que é aberta, defina as seguintes configurações:

   - **Name**: Insira um nome exclusivo e descritivo para a regra.

   - Clique em **mais opções**.

   - **Aplicar esta regra se**: selecionar **qualquer anexo** \> **tem conteúdo executável**.

   - **Faça o seguinte**: selecione **bloquear a mensagem** e, em seguida, escolha a ação desejada:

     - **rejeitar a mensagem e incluir uma explicação**: na caixa de diálogo **especificar motivo de rejeição** que aparece, insira o texto que você deseja que apareça na notificação de falha na entrega (também conhecida como uma mensagem de erro de notificação de falha na entrega). O código de status avançado padrão usado é 5.7.1.

     - **rejeitar a mensagem com o código de status avançado de**: na caixa de diálogo **Inserir código de status avançado** que aparece, insira o código de status avançado que você deseja que apareça na notificação de falha na entrega. Os valores válidos são 5.7.1 ou um valor de 5.7.900 a 5.7.999. O texto de rejeição padrão é: entrega não autorizada, mensagem recusada.

     - **rejeitar a mensagem sem notificar ninguém**

4. Quando concluir, clique em **Salvar**. A sua regra de bloqueio de anexo agora está em vigor.

## <a name="use-powershell-to-create-a-rule-that-blocks-messages-with-executable-attachments"></a>Use o PowerShell para criar uma regra que bloqueie mensagens com anexos executáveis

Use a seguinte sintaxe para criar uma regra para bloquear mensagens que contenham anexos executáveis:

```powershell
New-TransportRule -Name "<UniqueName>" -AttachmentHasExecutableContent $true [-RejectMessageEnhancedStatusCode <5.7.1 | 5.7.900 to 5.7.999>] [-RejectMessageReasonText "<Text>"] [-DeleteMessage $true]
```

**Observações**:

- Se você usar o parâmetro _RejectMessageEnhancedStatusCode_ sem o parâmetro _RejectMessageReasonText_ , o texto padrão será: Delivery não autorizado, mensagem recusada.

- Se você usar o parâmetro _RejectMessageReasonText_ sem o parâmetro _RejectMessageEnhancedStatusCode_ , o código padrão será 5.7.1.

Este exemplo cria uma nova regra chamada bloquear anexos executáveis que exclui silenciosamente mensagens que contêm anexos executáveis.

```powershell
New-TransportRule -Name "Block Executable Attachments" -AttachmentHasExecutableContent $true -DeleteMessage $true
```

Para obter informações detalhadas sobre sintaxe e parâmetro, consulte [New-TransportRule](https://docs.microsoft.com/powershell/module/exchange/new-transportrule).

## <a name="how-do-you-know-this-worked"></a>Como saber se funcionou?

Para verificar se você criou com êxito uma regra de fluxo de emails para bloquear mensagens que contenham anexos executáveis, execute uma das seguintes etapas:

- No Eat, vá para regras de **fluxo de emails** \>  \> Selecione a regra \> clique em **Editar** ![ ícone de edição ](../../media/ITPro-EAC-EditIcon.png) e verifique as configurações.

- No PowerShell, execute o seguinte comando para verificar as configurações:

  ```powershell
  Get-TransportRule -Identity "<Rule Name>" | Format-List Name,AttachmentHasExecutableContent,RejectMessage*,DeleteMessage
  ```
