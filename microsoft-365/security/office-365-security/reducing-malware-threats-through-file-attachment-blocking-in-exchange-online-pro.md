---
title: Usar regras de fluxo de email para bloquear mensagens com anexos executáveis
f1.keywords:
- NOCSH
ms.author: chrisda
author: chrisda
manager: dansimp
ms.date: ''
audience: ITPro
ms.topic: article
ms.service: O365-seccomp
localization_priority: Normal
ms.assetid: c4fb4a86-b772-49d0-8773-e8ee897e175d
ms.custom:
- seo-marvel-apr2020
description: Os administradores podem aprender a criar regras de fluxo de emails (regras de transporte) para bloquear mensagens que contenham anexos executáveis.
ms.openlocfilehash: 97647906103458a4189f6d1e47df13db8a4e1f01
ms.sourcegitcommit: 8e655c6cbb91bfb97efda9a99c39fac33eaa974a
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 05/13/2020
ms.locfileid: "44213147"
---
# <a name="use-mail-flow-rules-to-block-messages-with-executable-attachments-in-eop"></a><span data-ttu-id="6848a-103">Usar regras de fluxo de email para bloquear mensagens com anexos executáveis no EOP</span><span class="sxs-lookup"><span data-stu-id="6848a-103">Use mail flow rules to block messages with executable attachments in EOP</span></span>

<span data-ttu-id="6848a-104">Nas organizações do Microsoft 365 com caixas de correio em organizações do Exchange Online ou do Exchange Online Protection (EOP) sem caixas de correio do Exchange Online, o EOP usa políticas antimalware para bloquear mensagens perigosas, incluindo mensagens com anexos executáveis.</span><span class="sxs-lookup"><span data-stu-id="6848a-104">In Microsoft 365 organizations with mailboxes in Exchange Online or standalone Exchange Online Protection (EOP) organizations without Exchange Online mailboxes, EOP uses anti-malware policies to block harmful messages, including messages with executable attachments.</span></span> <span data-ttu-id="6848a-105">Para obter mais informações, consulte [proteção Antimalware no EOP](anti-malware-protection.md).</span><span class="sxs-lookup"><span data-stu-id="6848a-105">For more information, see [Anti-malware protection in EOP](anti-malware-protection.md).</span></span>

<span data-ttu-id="6848a-106">Para aprimorar ainda mais a proteção, você pode usar regras de fluxo de emails (também conhecidas como regras de transporte) para identificar e bloquear mensagens que contenham anexos executáveis, conforme descrito neste tópico.</span><span class="sxs-lookup"><span data-stu-id="6848a-106">To further enhance protection, you can use mail flow rules (also known as transport rules) to identify and block messages that contain executable attachments as described in this topic.</span></span>

<span data-ttu-id="6848a-107">Por exemplo, seguindo uma epidemia de malware, uma empresa pode aplicar essa regra com um limite de tempo para que os usuários afetados possam voltar a enviar anexos após um período de tempo especificado.</span><span class="sxs-lookup"><span data-stu-id="6848a-107">For example, following a malware outbreak, a company could apply this rule with a time limit so that affected users can get back to sending attachments after a specified length of time.</span></span>

## <a name="what-do-you-need-to-know-before-you-begin"></a><span data-ttu-id="6848a-108">O que você precisa saber antes de começar?</span><span class="sxs-lookup"><span data-stu-id="6848a-108">What do you need to know before you begin?</span></span>

- <span data-ttu-id="6848a-109">Você precisa ter permissões para poder executar estes procedimentos:</span><span class="sxs-lookup"><span data-stu-id="6848a-109">You need to be assigned permissions before you can do these procedures:</span></span>

  - <span data-ttu-id="6848a-110">No Exchange Online, consulte o entrada "fluxo de email" em [permissões de recurso no Exchange Online](https://docs.microsoft.com/Exchange/permissions-exo/feature-permissions).</span><span class="sxs-lookup"><span data-stu-id="6848a-110">In Exchange Online, see the "Mail flow" entry in [Feature Permissions in Exchange Online](https://docs.microsoft.com/Exchange/permissions-exo/feature-permissions).</span></span>
  
  - <span data-ttu-id="6848a-111">Em EOP autônomo, você precisa da função de regras de transporte, que é atribuída às funções gerenciamento, ComplianceManagement e RecordsManagement por padrão.</span><span class="sxs-lookup"><span data-stu-id="6848a-111">In standalone EOP, you need the Transport Rules role, which is assigned to the OrganizationManagement, ComplianceManagement, and RecordsManagement roles by default.</span></span> <span data-ttu-id="6848a-112">Para obter mais informações, consulte [permissões em EOP autônomos](feature-permissions-in-eop.md) e [use o Eat modificar a lista de membros nos grupos de função](manage-admin-role-group-permissions-in-eop.md#use-the-eac-modify-the-list-of-members-in-role-groups).</span><span class="sxs-lookup"><span data-stu-id="6848a-112">For more information, see [Permissions in standalone EOP](feature-permissions-in-eop.md) and [Use the EAC modify the list of members in role groups](manage-admin-role-group-permissions-in-eop.md#use-the-eac-modify-the-list-of-members-in-role-groups).</span></span>

- <span data-ttu-id="6848a-113">Para abrir o Eat no Exchange Online, confira [Exchange Admin Center in Exchange Online](https://docs.microsoft.com/Exchange/exchange-admin-center).</span><span class="sxs-lookup"><span data-stu-id="6848a-113">To open the EAC in Exchange Online, see [Exchange admin center in Exchange Online](https://docs.microsoft.com/Exchange/exchange-admin-center).</span></span> <span data-ttu-id="6848a-114">Para abrir o Eat no EOP autônomo, confira [centro de administração do Exchange no EOP autônomo](exchange-admin-center-in-exchange-online-protection-eop.md).</span><span class="sxs-lookup"><span data-stu-id="6848a-114">To open the EAC in standalone EOP, see [Exchange admin center in standalone EOP](exchange-admin-center-in-exchange-online-protection-eop.md).</span></span>

- <span data-ttu-id="6848a-115">Para se conectar ao PowerShell do Exchange Online, confira [Conectar ao PowerShell do Exchange Online](https://docs.microsoft.com/powershell/exchange/exchange-online/connect-to-exchange-online-powershell/connect-to-exchange-online-powershell).</span><span class="sxs-lookup"><span data-stu-id="6848a-115">To connect to Exchange Online PowerShell, see [Connect to Exchange Online PowerShell](https://docs.microsoft.com/powershell/exchange/exchange-online/connect-to-exchange-online-powershell/connect-to-exchange-online-powershell).</span></span> <span data-ttu-id="6848a-116">Para se conectar ao PowerShell do EOP autônomo, confira [conectar-se ao PowerShell do Exchange Online Protection](https://docs.microsoft.com/powershell/exchange/exchange-eop/connect-to-exchange-online-protection-powershell).</span><span class="sxs-lookup"><span data-stu-id="6848a-116">To connect to standalone EOP PowerShell, see [Connect to Exchange Online Protection PowerShell](https://docs.microsoft.com/powershell/exchange/exchange-eop/connect-to-exchange-online-protection-powershell).</span></span>

- <span data-ttu-id="6848a-117">Para obter mais informações sobre regras de fluxo de emails no Exchange Online e EOP autônomos, consulte os seguintes tópicos:</span><span class="sxs-lookup"><span data-stu-id="6848a-117">For more information about mail flow rules in Exchange Online and standalone EOP, see the following topics:</span></span>

  - [<span data-ttu-id="6848a-118">Regras de fluxo de emails (regras de transporte) no Exchange Online</span><span class="sxs-lookup"><span data-stu-id="6848a-118">Mail flow rules (transport rules) in Exchange Online</span></span>](https://docs.microsoft.com/Exchange/security-and-compliance/mail-flow-rules/mail-flow-rules)

  - [<span data-ttu-id="6848a-119">Condições e exceções de regra de fluxo de emails (predicados) no Exchange Online</span><span class="sxs-lookup"><span data-stu-id="6848a-119">Mail flow rule conditions and exceptions (predicates) in Exchange Online</span></span>](https://docs.microsoft.com/Exchange/security-and-compliance/mail-flow-rules/conditions-and-exceptions)

  - [<span data-ttu-id="6848a-120">Ações de regra de fluxo de email no Exchange Online</span><span class="sxs-lookup"><span data-stu-id="6848a-120">Mail flow rule actions in Exchange Online</span></span>](https://docs.microsoft.com/Exchange/security-and-compliance/mail-flow-rules/mail-flow-rule-actions)

## <a name="use-the-eac-to-create-a-rule-that-blocks-messages-with-executable-attachments"></a><span data-ttu-id="6848a-121">Use o Eat para criar uma regra que bloqueie mensagens com anexos executáveis</span><span class="sxs-lookup"><span data-stu-id="6848a-121">Use the EAC to create a rule that blocks messages with executable attachments</span></span>

1. <span data-ttu-id="6848a-122">No EAC, vá para **Fluxo de emails** \> **Regras**.</span><span class="sxs-lookup"><span data-stu-id="6848a-122">In the EAC, go to **Mail flow** \> **Rules**.</span></span>

2. <span data-ttu-id="6848a-123">Clique em **Adicionar** ![ ícone ](../../media/ITPro-EAC-AddIcon.png) de adição e selecione **criar uma nova regra**.</span><span class="sxs-lookup"><span data-stu-id="6848a-123">Click **Add** ![Add icon](../../media/ITPro-EAC-AddIcon.png) and then select **Create a new rule**.</span></span>

3. <span data-ttu-id="6848a-124">Na página **nova regra** que é aberta, defina as seguintes configurações:</span><span class="sxs-lookup"><span data-stu-id="6848a-124">In the **New rule** page that opens, configure the following settings:</span></span>

   - <span data-ttu-id="6848a-125">**Name**: Insira um nome exclusivo e descritivo para a regra.</span><span class="sxs-lookup"><span data-stu-id="6848a-125">**Name**: Enter a unique, descriptive name for the rule.</span></span>

   - <span data-ttu-id="6848a-126">Clique em **mais opções**.</span><span class="sxs-lookup"><span data-stu-id="6848a-126">Click **More Options**.</span></span>

   - <span data-ttu-id="6848a-127">**Aplicar esta regra se**: selecionar **qualquer anexo** \> **tem conteúdo executável**.</span><span class="sxs-lookup"><span data-stu-id="6848a-127">**Apply this rule if**: Select **Any attachment** \> **has executable content**.</span></span>

   - <span data-ttu-id="6848a-128">**Faça o seguinte**: selecione **bloquear a mensagem** e, em seguida, escolha a ação desejada:</span><span class="sxs-lookup"><span data-stu-id="6848a-128">**Do the following**: Select **Block the message** and then choose the action you want:</span></span>

     - <span data-ttu-id="6848a-129">**rejeitar a mensagem e incluir uma explicação**: na caixa de diálogo **especificar motivo de rejeição** que aparece, insira o texto que você deseja que apareça na notificação de falha na entrega (também conhecida como uma mensagem de erro de notificação de falha na entrega).</span><span class="sxs-lookup"><span data-stu-id="6848a-129">**reject the message and include an explanation**: In the **Specify reject reason** dialog that appears, enter the text you want to appear in the non-delivery report (also known as an NDR or bounce message).</span></span> <span data-ttu-id="6848a-130">O código de status avançado padrão usado é 5.7.1.</span><span class="sxs-lookup"><span data-stu-id="6848a-130">The default enhanced status code that's used is 5.7.1.</span></span>

     - <span data-ttu-id="6848a-131">**rejeitar a mensagem com o código de status avançado de**: na caixa de diálogo **Inserir código de status avançado** que aparece, insira o código de status avançado que você deseja que apareça na notificação de falha na entrega.</span><span class="sxs-lookup"><span data-stu-id="6848a-131">**reject the message with the enhanced status code of**:  In the **Enter enhanced status code** dialog that appears, enter the enhanced status code that you want to appear in the NDR.</span></span> <span data-ttu-id="6848a-132">Os valores válidos são 5.7.1 ou um valor de 5.7.900 a 5.7.999.</span><span class="sxs-lookup"><span data-stu-id="6848a-132">Valid values are 5.7.1 or a value from 5.7.900 to 5.7.999.</span></span> <span data-ttu-id="6848a-133">O texto de rejeição padrão é: entrega não autorizada, mensagem recusada.</span><span class="sxs-lookup"><span data-stu-id="6848a-133">The default rejection text is: Delivery not authorized, message refused.</span></span>

     - <span data-ttu-id="6848a-134">**rejeitar a mensagem sem notificar ninguém**</span><span class="sxs-lookup"><span data-stu-id="6848a-134">**reject the message without notifying anyone**</span></span>

4. <span data-ttu-id="6848a-135">Quando concluir, clique em **Salvar**.</span><span class="sxs-lookup"><span data-stu-id="6848a-135">When you're finished, click **Save**.</span></span> <span data-ttu-id="6848a-136">A sua regra de bloqueio de anexo agora está em vigor.</span><span class="sxs-lookup"><span data-stu-id="6848a-136">Your attachment blocking rule is now in force.</span></span>

## <a name="use-powershell-to-create-a-rule-that-blocks-messages-with-executable-attachments"></a><span data-ttu-id="6848a-137">Use o PowerShell para criar uma regra que bloqueie mensagens com anexos executáveis</span><span class="sxs-lookup"><span data-stu-id="6848a-137">Use PowerShell to create a rule that blocks messages with executable attachments</span></span>

<span data-ttu-id="6848a-138">Use a seguinte sintaxe para criar uma regra para bloquear mensagens que contenham anexos executáveis:</span><span class="sxs-lookup"><span data-stu-id="6848a-138">Use the following syntax to create a rule to blocks messages that contain executable attachments:</span></span>

```powershell
New-TransportRule -Name "<UniqueName>" -AttachmentHasExecutableContent $true [-RejectMessageEnhancedStatusCode <5.7.1 | 5.7.900 to 5.7.999>] [-RejectMessageReasonText "<Text>"] [-DeleteMessage $true]
```

<span data-ttu-id="6848a-139">**Observações**:</span><span class="sxs-lookup"><span data-stu-id="6848a-139">**Notes**:</span></span>

- <span data-ttu-id="6848a-140">Se você usar o parâmetro _RejectMessageEnhancedStatusCode_ sem o parâmetro _RejectMessageReasonText_ , o texto padrão será: Delivery não autorizado, mensagem recusada.</span><span class="sxs-lookup"><span data-stu-id="6848a-140">If you use the _RejectMessageEnhancedStatusCode_ parameter without the _RejectMessageReasonText_ parameter, the default text is: Delivery not authorized, message refused.</span></span>

- <span data-ttu-id="6848a-141">Se você usar o parâmetro _RejectMessageReasonText_ sem o parâmetro _RejectMessageEnhancedStatusCode_ , o código padrão será 5.7.1.</span><span class="sxs-lookup"><span data-stu-id="6848a-141">If you use the _RejectMessageReasonText_ parameter without the _RejectMessageEnhancedStatusCode_ parameter, the default code is 5.7.1.</span></span>

<span data-ttu-id="6848a-142">Este exemplo cria uma nova regra chamada bloquear anexos executáveis que exclui silenciosamente mensagens que contêm anexos executáveis.</span><span class="sxs-lookup"><span data-stu-id="6848a-142">This example creates a new rule named Block Executable Attachments that silently deletes messages that contain executable attachments.</span></span>

```powershell
New-TransportRule -Name "Block Executable Attachments" -AttachmentHasExecutableContent $true -DeleteMessage $true
```

<span data-ttu-id="6848a-143">Para obter informações detalhadas sobre sintaxe e parâmetro, consulte [New-TransportRule](https://docs.microsoft.com/powershell/module/exchange/policy-and-compliance/new-transportrule).</span><span class="sxs-lookup"><span data-stu-id="6848a-143">For detailed syntax and parameter information, see [New-TransportRule](https://docs.microsoft.com/powershell/module/exchange/policy-and-compliance/new-transportrule).</span></span>

## <a name="how-do-you-know-this-worked"></a><span data-ttu-id="6848a-144">Como saber se funcionou?</span><span class="sxs-lookup"><span data-stu-id="6848a-144">How do you know this worked?</span></span>

<span data-ttu-id="6848a-145">Para verificar se você criou com êxito uma regra de fluxo de emails para bloquear mensagens que contenham anexos executáveis, execute uma das seguintes etapas:</span><span class="sxs-lookup"><span data-stu-id="6848a-145">To verify that you've successfully create a mail flow rule to block messages that contain executable attachments, do any of the following steps:</span></span>

- <span data-ttu-id="6848a-146">No Eat, vá para regras de **fluxo de emails** \> **Rules** \> Selecione a regra \> clique em **Editar** ![ ícone de edição ](../../media/ITPro-EAC-EditIcon.png) e verifique as configurações.</span><span class="sxs-lookup"><span data-stu-id="6848a-146">In the EAC, go to **Mail flow** \> **Rules** \> select the rule \> click **Edit** ![Edit icon](../../media/ITPro-EAC-EditIcon.png), and verify the settings.</span></span>

- <span data-ttu-id="6848a-147">No PowerShell, execute o seguinte comando para verificar as configurações:</span><span class="sxs-lookup"><span data-stu-id="6848a-147">In PowerShell, run the following command to verify the settings:</span></span>

  ```powershell
  Get-TransportRule -Identity "<Rule Name>" | Format-List Name,AttachmentHasExecutableContent,RejectMessage*,DeleteMessage
  ```
