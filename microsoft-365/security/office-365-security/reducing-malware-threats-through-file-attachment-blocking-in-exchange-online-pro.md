---
title: Usar regras de fluxo de emails para bloquear mensagens com anexos executáveis
f1.keywords:
- NOCSH
ms.author: chrisda
author: chrisda
manager: dansimp
ms.date: ''
audience: ITPro
ms.topic: how-to
localization_priority: Normal
ms.assetid: c4fb4a86-b772-49d0-8773-e8ee897e175d
ms.custom:
- seo-marvel-apr2020
description: Os administradores podem aprender a criar regras de fluxo de emails (regras de transporte) para bloquear mensagens que contêm anexos executáveis.
ms.technology: mdo
ms.prod: m365-security
ms.openlocfilehash: 8631ae2a1370e338bfcc689c72d09533c39397a9
ms.sourcegitcommit: 27b2b2e5c41934b918cac2c171556c45e36661bf
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 03/19/2021
ms.locfileid: "50916905"
---
# <a name="use-mail-flow-rules-to-block-messages-with-executable-attachments-in-eop"></a>Usar regras de fluxo de email para bloquear mensagens com anexos executáveis no EOP

[!INCLUDE [Microsoft 365 Defender rebranding](../includes/microsoft-defender-for-office.md)]

**Aplica-se a**
- [Proteção do Exchange Online](exchange-online-protection-overview.md)
- [Plano 1 e plano 2 do Microsoft Defender para Office 365](office-365-atp.md)
- [Microsoft 365 Defender](../mtp/microsoft-threat-protection.md)

Em organizações do Microsoft 365 com caixas de correio no Exchange Online ou organizações autônomas do Exchange Online Protection (EOP) sem caixas de correio do Exchange Online, o EOP usa políticas anti-malware para bloquear mensagens prejudiciais, incluindo mensagens com anexos executáveis. Para obter mais informações, consulte [Proteção anti-malware no EOP](anti-malware-protection.md).

Para aprimorar ainda mais a proteção, você pode usar regras de fluxo de emails (também conhecidas como regras de transporte) para identificar e bloquear mensagens que contenham anexos executáveis, conforme descrito neste artigo.

Por exemplo, após uma epidemia de malware, uma empresa pode aplicar essa regra com um limite de tempo para que os usuários afetados possam voltar ao envio de anexos após um período especificado.

## <a name="what-do-you-need-to-know-before-you-begin"></a>O que você precisa saber antes de começar?

- Você precisa ter permissões atribuídas no Exchange Online ou no Exchange Online Protection antes de poder fazer os procedimentos neste artigo. Especificamente, você precisa da função **Regras** de Transporte, que é  atribuída aos grupos de função Gerenciamento da **Organização,** Gerenciamento de **Conformidade** e Gerenciamento de Registros por padrão.

  Para mais informações, confira os seguintes tópicos:

  - [Permissões no Exchange Online](/exchange/permissions-exo/permissions-exo)
  - [Permissões no EOP autônomo](feature-permissions-in-eop.md)
  - [Usar o EAC modificar a lista de membros em grupos de função](manage-admin-role-group-permissions-in-eop.md#use-the-eac-modify-the-list-of-members-in-role-groups)

- Para abrir o EAC no Exchange Online, consulte [Centro de administração do Exchange no Exchange Online](/Exchange/exchange-admin-center). Para abrir o EAC no EOP autônomo, consulte Centro de administração [do Exchange no EOP](exchange-admin-center-in-exchange-online-protection-eop.md)autônomo .

- Para se conectar ao PowerShell do Exchange Online, confira [Conectar ao PowerShell do Exchange Online](/powershell/exchange/connect-to-exchange-online-powershell). Para se conectar ao EOP PowerShell autônomo, consulte [Conectar-se ao PowerShell do Exchange Online Protection.](/powershell/exchange/connect-to-exchange-online-protection-powershell).

- Para obter mais informações sobre regras de fluxo de emails no Exchange Online e no EOP autônomo, consulte os seguintes tópicos:

  - [Regras de fluxo de emails (regras de transporte) no Exchange Online](/Exchange/security-and-compliance/mail-flow-rules/mail-flow-rules)

  - [Condições e exceções de regra de fluxo de email (predicados) no Exchange Online](/Exchange/security-and-compliance/mail-flow-rules/conditions-and-exceptions)

  - [Ações de regra de fluxo de emails no Exchange Online](/Exchange/security-and-compliance/mail-flow-rules/mail-flow-rule-actions)

## <a name="use-the-eac-to-create-a-rule-that-blocks-messages-with-executable-attachments"></a>Use o EAC para criar uma regra que bloqueia mensagens com anexos executáveis

1. No EAC, vá para **Fluxo de emails** \> **Regras**.

2. Clique **em Adicionar** ícone e selecione Criar uma nova ![ ](../../media/ITPro-EAC-AddIcon.png) **regra.**

3. Na página **Nova regra** que é aberta, configure as seguintes configurações:

   - **Nome**: Insira um nome exclusivo e descritivo para a regra.

   - Clique **em Mais Opções**.

   - **Aplique essa regra se**: Selecionar **Qualquer anexo** tiver \> **conteúdo executável**.

   - **Faça o seguinte:** Selecione **Bloquear a mensagem** e escolha a ação que deseja:

     - **rejeitar a mensagem** e incluir  uma explicação : na caixa de diálogo Especificar motivo de rejeição que aparece, insira o texto que você deseja que apareça no relatório de não entrega (também conhecido como NDR ou mensagem de rejeição). O código de status aprimorado padrão usado é 5.7.1.

     - **rejeitar a mensagem com o** código de status aprimorado de : Na caixa de diálogo Inserir código de **status** aprimorado que aparece, insira o código de status aprimorado que você deseja aparecer na NDR. Os valores válidos são 5.7.1 ou um valor de 5,7.900 a 5.7.999. O texto de rejeição padrão é: Entrega não autorizada, mensagem recusada.

     - **rejeitar a mensagem sem notificar ninguém**

4. Quando concluir, clique em **Salvar**. A sua regra de bloqueio de anexo agora está em vigor.

## <a name="use-powershell-to-create-a-rule-that-blocks-messages-with-executable-attachments"></a>Use o PowerShell para criar uma regra que bloqueia mensagens com anexos executáveis

Use a sintaxe a seguir para criar uma regra para bloquear mensagens que contenham anexos executáveis:

```powershell
New-TransportRule -Name "<UniqueName>" -AttachmentHasExecutableContent $true [-RejectMessageEnhancedStatusCode <5.7.1 | 5.7.900 to 5.7.999>] [-RejectMessageReasonText "<Text>"] [-DeleteMessage $true]
```

**Observações**:

- Se você usar o _parâmetro RejectMessageEnhancedStatusCode_ sem o parâmetro _RejectMessageReasonText,_ o texto padrão será: Entrega não autorizada, mensagem recusada.

- Se você usar o _parâmetro RejectMessageReasonText_ sem o _parâmetro RejectMessageEnhancedStatusCode,_ o código padrão será 5.7.1.

Este exemplo cria uma nova regra chamada Bloquear Anexos Executáveis que exclui silenciosamente mensagens que contêm anexos executáveis.

```powershell
New-TransportRule -Name "Block Executable Attachments" -AttachmentHasExecutableContent $true -DeleteMessage $true
```

Para obter informações detalhadas sobre sintaxe e parâmetro, consulte [New-TransportRule](/powershell/module/exchange/new-transportrule).

## <a name="how-do-you-know-this-worked"></a>Como saber se funcionou?

Para verificar se você criou com êxito uma regra de fluxo de emails para bloquear mensagens que contêm anexos executáveis, faça qualquer uma das seguintes etapas:

- No EAC, vá para **Regras de fluxo de** email selecione a regra clique em \>  \> \> **Editar** ícone editar e verifique ![ as ](../../media/ITPro-EAC-EditIcon.png) configurações.

- No PowerShell, execute o seguinte comando para verificar as configurações:

  ```powershell
  Get-TransportRule -Identity "<Rule Name>" | Format-List Name,AttachmentHasExecutableContent,RejectMessage*,DeleteMessage
  ```