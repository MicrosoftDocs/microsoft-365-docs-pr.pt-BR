---
title: Referência de proteção de exploração
keywords: mitigações, vulnerabilidades, vulnerabilidades, mitigação, exploração, explorações, emet
description: Detalhes sobre como o recurso de proteção de exploração funciona no Windows 10
search.product: eADQiWindows 10XVcnh
ms.pagetype: security
ms.prod: m365-security
ms.mktglfcycl: manage
ms.sitesec: library
localization_priority: Normal
audience: ITPro
author: denisebmsft
ms.author: deniseb
ms.date: 01/06/2021
ms.reviewer: cjacks
manager: dansimp
ms.custom: asr
ms.technology: mde
ms.topic: article
ms.openlocfilehash: a87215b0e23d56a73259bbee4600ec9e15a27f3b
ms.sourcegitcommit: dcb97fbfdae52960ae62b6faa707a05358193ed5
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 03/25/2021
ms.locfileid: "51199340"
---
# <a name="exploit-protection-reference"></a><span data-ttu-id="a89c2-104">Referência de Proteção de Exploração</span><span class="sxs-lookup"><span data-stu-id="a89c2-104">Exploit Protection Reference</span></span>

[!INCLUDE [Microsoft 365 Defender rebranding](../../includes/microsoft-defender.md)]


<span data-ttu-id="a89c2-105">**Aplica-se a:**</span><span class="sxs-lookup"><span data-stu-id="a89c2-105">**Applies to:**</span></span>
- [<span data-ttu-id="a89c2-106">Microsoft Defender para Ponto de Extremidade</span><span class="sxs-lookup"><span data-stu-id="a89c2-106">Microsoft Defender for Endpoint</span></span>](https://go.microsoft.com/fwlink/?linkid=2154037)
- [<span data-ttu-id="a89c2-107">Microsoft 365 Defender</span><span class="sxs-lookup"><span data-stu-id="a89c2-107">Microsoft 365 Defender</span></span>](https://go.microsoft.com/fwlink/?linkid=2118804)

><span data-ttu-id="a89c2-108">Deseja experimentar o Microsoft Defender para Ponto de Extremidade?</span><span class="sxs-lookup"><span data-stu-id="a89c2-108">Want to experience Microsoft Defender for Endpoint?</span></span> [<span data-ttu-id="a89c2-109">Inscreva-se para uma avaliação gratuita.</span><span class="sxs-lookup"><span data-stu-id="a89c2-109">Sign up for a free trial.</span></span>](https://www.microsoft.com/microsoft-365/windows/microsoft-defender-atp?ocid=docs-wdatp-enablesiem-abovefoldlink)

<span data-ttu-id="a89c2-110">A proteção de exploração fornece proteções avançadas para aplicativos que o Profissional de IT pode aplicar depois que o desenvolvedor compilou e distribuiu o software.</span><span class="sxs-lookup"><span data-stu-id="a89c2-110">Exploit protection provides advanced protections for applications that the IT Pro can apply after the developer has compiled and distributed the software.</span></span>

<span data-ttu-id="a89c2-111">Este artigo ajuda você a entender como funciona a proteção de exploração, no nível da política e no nível de mitigação individual, para ajudá-lo a criar e aplicar políticas de Proteção de Exploração com êxito.</span><span class="sxs-lookup"><span data-stu-id="a89c2-111">This article helps you understand how exploit protection works, both at the policy level and at the individual mitigation level, to help you successfully build and apply Exploit Protection policies.</span></span>

## <a name="how-mitigations-are-applied"></a><span data-ttu-id="a89c2-112">Como as mitigações são aplicadas</span><span class="sxs-lookup"><span data-stu-id="a89c2-112">How mitigations are applied</span></span>

<span data-ttu-id="a89c2-113">As mitigações do Exploit Protection são aplicadas por aplicativo.</span><span class="sxs-lookup"><span data-stu-id="a89c2-113">Exploit Protection mitigations are applied per application.</span></span>

<span data-ttu-id="a89c2-114">As mitigações são configuradas por meio de uma entrada do Registro para cada programa para o que você configura proteções.</span><span class="sxs-lookup"><span data-stu-id="a89c2-114">Mitigations are configured via a registry entry for each program that you configure protections for.</span></span> <span data-ttu-id="a89c2-115">Essas configurações são armazenadas na entrada do Registro **MitigationOptions** para cada programa (**HKEY_LOCAL_MACHINE \ SOFTWARE \ Microsoft \ Windows NT \ CurrentVersion \ Image File Execution Options \ *ImageFileName* \ MitigationOptions**).</span><span class="sxs-lookup"><span data-stu-id="a89c2-115">These settings are stored in the **MitigationOptions** registry entry for each program (**HKEY_LOCAL_MACHINE \ SOFTWARE \ Microsoft \ Windows NT \ CurrentVersion \ Image File Execution Options \ *ImageFileName* \ MitigationOptions**).</span></span> <span data-ttu-id="a89c2-116">Eles fazem efeito quando você reinicia o programa e permanece em vigor até que você os altere e reinicie o programa novamente.</span><span class="sxs-lookup"><span data-stu-id="a89c2-116">They take effect when you restart the program and remain effective until you change them and restart the program again.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="a89c2-117">As Opções de Execução de Arquivo de Imagem permitem apenas que você especifique um nome de arquivo ou caminho, e não um número de versão, arquitetura ou qualquer outro diferencial.</span><span class="sxs-lookup"><span data-stu-id="a89c2-117">Image File Execution Options only allows you to specify a file name or path, and not a version number, architecture, or any other differentiator.</span></span> <span data-ttu-id="a89c2-118">Tenha cuidado para direcionar mitigações a aplicativos que têm nomes ou caminhos exclusivos, aplicando-os apenas em dispositivos em que você testou essa versão e essa arquitetura do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="a89c2-118">Be careful to target mitigations to apps which have unique names or paths, applying them only on devices where you have tested that version and that architecture of the application.</span></span>

<span data-ttu-id="a89c2-119">Se você configurar mitigações de proteção de exploração usando um arquivo de configuração XML, por meio do PowerShell, da Política de Grupo ou do MDM, ao processar esse arquivo de configuração XML, as configurações individuais do Registro serão configuradas para você.</span><span class="sxs-lookup"><span data-stu-id="a89c2-119">If you configure exploit protection mitigations using an XML configuration file, either via PowerShell, Group Policy, or MDM, when processing this XML configuration file, individual registry settings will be configured for you.</span></span>

<span data-ttu-id="a89c2-120">Quando a política de distribuição do arquivo XML não for mais imposta, as configurações implantadas por esse arquivo de configuração XML não serão removidas automaticamente.</span><span class="sxs-lookup"><span data-stu-id="a89c2-120">When the policy distributing the XML file is no longer enforced, settings deployed by this XML configuration file will not be automatically removed.</span></span> <span data-ttu-id="a89c2-121">Para remover as configurações do Exploit Protection, exporte a configuração XML de um dispositivo Windows 10 limpo e implante esse novo arquivo XML.</span><span class="sxs-lookup"><span data-stu-id="a89c2-121">To remove Exploit Protection settings, export the XML configuration from a clean Windows 10 device, and deploy this new XML file.</span></span> <span data-ttu-id="a89c2-122">Como alternativa, a Microsoft fornece um arquivo XML como parte das Linhas de Base de Segurança do Windows para redefinir as configurações do Exploit Protection.</span><span class="sxs-lookup"><span data-stu-id="a89c2-122">Alternately, Microsoft provides an XML file as part of the Windows Security Baselines for resetting Exploit Protection settings.</span></span>

<span data-ttu-id="a89c2-123">Para redefinir as configurações de proteção de exploração usando o PowerShell, você pode usar o seguinte comando:</span><span class="sxs-lookup"><span data-stu-id="a89c2-123">To reset exploit protection settings using PowerShell, you could use the following command:</span></span>

```powershell
Set-ProcessMitigation -PolicyFilePath EP-reset.xml
```
<span data-ttu-id="a89c2-124">A seguir está o EP-reset.xml distribuído com as Linhas de Base de Segurança do Windows:</span><span class="sxs-lookup"><span data-stu-id="a89c2-124">Following is the EP-reset.xml distributed with the Windows Security Baselines:</span></span>
```xml
<?xml version="1.0" encoding="UTF-8"?>
<MitigationPolicy>
  <AppConfig Executable="ONEDRIVE.EXE">
    <DEP OverrideDEP="false" />
    <ASLR OverrideRelocateImages="false" />
    <Payload OverrideEnableExportAddressFilter="false" OverrideEnableExportAddressFilterPlus="false" OverrideEnableImportAddressFilter="false" OverrideEnableRopStackPivot="false" OverrideEnableRopCallerCheck="false" OverrideEnableRopSimExec="false" />
    <ImageLoad OverrideBlockRemoteImages="false" />
  </AppConfig>
  <AppConfig Executable="firefox.exe">
    <DEP OverrideDEP="false" />
    <ASLR ForceRelocateImages="true" />
  </AppConfig>
  <AppConfig Executable="fltldr.exe">
    <DEP OverrideDEP="false" />
    <Payload OverrideEnableExportAddressFilter="false" OverrideEnableExportAddressFilterPlus="false" OverrideEnableImportAddressFilter="false" OverrideEnableRopStackPivot="false" OverrideEnableRopCallerCheck="false" OverrideEnableRopSimExec="false" />
    <ImageLoad OverrideBlockRemoteImages="false" />
    <ChildProcess OverrideChildProcess="false" />
  </AppConfig>
  <AppConfig Executable="GROOVE.EXE">
    <DEP OverrideDEP="false" />
    <ASLR ForceRelocateImages="true" />
    <Payload OverrideEnableExportAddressFilter="false" OverrideEnableExportAddressFilterPlus="false" OverrideEnableImportAddressFilter="false" OverrideEnableRopStackPivot="false" OverrideEnableRopCallerCheck="false" OverrideEnableRopSimExec="false" />
    <ImageLoad OverrideBlockRemoteImages="false" />
    <ChildProcess OverrideChildProcess="false" />
  </AppConfig>
  <AppConfig Executable="Acrobat.exe">
    <DEP OverrideDEP="false" />
    <ASLR ForceRelocateImages="true" />
    <Payload OverrideEnableExportAddressFilter="false" OverrideEnableExportAddressFilterPlus="false" OverrideEnableImportAddressFilter="false" OverrideEnableRopStackPivot="false" OverrideEnableRopCallerCheck="false" OverrideEnableRopSimExec="false" />
  </AppConfig>
  <AppConfig Executable="AcroRd32.exe">
    <DEP OverrideDEP="false" />
    <ASLR ForceRelocateImages="true" />
    <Payload OverrideEnableExportAddressFilter="false" OverrideEnableExportAddressFilterPlus="false" OverrideEnableImportAddressFilter="false" OverrideEnableRopStackPivot="false" OverrideEnableRopCallerCheck="false" OverrideEnableRopSimExec="false" />
  </AppConfig>
  <AppConfig Executable="chrome.exe">
    <DEP OverrideDEP="false" />
  </AppConfig>
  <AppConfig Executable="EXCEL.EXE">
    <DEP OverrideDEP="false" />
    <ASLR ForceRelocateImages="true" />
    <Payload OverrideEnableExportAddressFilter="false" OverrideEnableExportAddressFilterPlus="false" OverrideEnableImportAddressFilter="false" OverrideEnableRopStackPivot="false" OverrideEnableRopCallerCheck="false" OverrideEnableRopSimExec="false" />
  </AppConfig>
  <AppConfig Executable="iexplore.exe">
    <DEP OverrideDEP="false" />
    <ASLR ForceRelocateImages="true" />
    <Payload OverrideEnableExportAddressFilter="false" OverrideEnableExportAddressFilterPlus="false" OverrideEnableImportAddressFilter="false" OverrideEnableRopStackPivot="false" OverrideEnableRopCallerCheck="false" OverrideEnableRopSimExec="false" />
  </AppConfig>
  <AppConfig Executable="INFOPATH.EXE">
    <DEP OverrideDEP="false" />
    <ASLR ForceRelocateImages="true" />
    <Payload OverrideEnableExportAddressFilter="false" OverrideEnableExportAddressFilterPlus="false" OverrideEnableImportAddressFilter="false" OverrideEnableRopStackPivot="false" OverrideEnableRopCallerCheck="false" OverrideEnableRopSimExec="false" />
  </AppConfig>
  <AppConfig Executable="java.exe">
    <DEP OverrideDEP="false" />
    <Payload OverrideEnableExportAddressFilter="false" OverrideEnableExportAddressFilterPlus="false" OverrideEnableImportAddressFilter="false" OverrideEnableRopStackPivot="false" OverrideEnableRopCallerCheck="false" OverrideEnableRopSimExec="false" />
  </AppConfig>
  <AppConfig Executable="javaw.exe">
    <DEP OverrideDEP="false" />
    <Payload OverrideEnableExportAddressFilter="false" OverrideEnableExportAddressFilterPlus="false" OverrideEnableImportAddressFilter="false" OverrideEnableRopStackPivot="false" OverrideEnableRopCallerCheck="false" OverrideEnableRopSimExec="false" />
  </AppConfig>
  <AppConfig Executable="javaws.exe">
    <DEP OverrideDEP="false" />
    <Payload OverrideEnableExportAddressFilter="false" OverrideEnableExportAddressFilterPlus="false" OverrideEnableImportAddressFilter="false" OverrideEnableRopStackPivot="false" OverrideEnableRopCallerCheck="false" OverrideEnableRopSimExec="false" />
  </AppConfig>
  <AppConfig Executable="LYNC.EXE">
    <DEP OverrideDEP="false" />
    <ASLR ForceRelocateImages="true" />
    <Payload OverrideEnableExportAddressFilter="false" OverrideEnableExportAddressFilterPlus="false" OverrideEnableImportAddressFilter="false" OverrideEnableRopStackPivot="false" OverrideEnableRopCallerCheck="false" OverrideEnableRopSimExec="false" />
  </AppConfig>
  <AppConfig Executable="MSACCESS.EXE">
    <DEP OverrideDEP="false" />
    <ASLR ForceRelocateImages="true" />
    <Payload OverrideEnableExportAddressFilter="false" OverrideEnableExportAddressFilterPlus="false" OverrideEnableImportAddressFilter="false" OverrideEnableRopStackPivot="false" OverrideEnableRopCallerCheck="false" OverrideEnableRopSimExec="false" />
  </AppConfig>
  <AppConfig Executable="MSPUB.EXE">
    <DEP OverrideDEP="false" />
    <ASLR ForceRelocateImages="true" />
    <Payload OverrideEnableExportAddressFilter="false" OverrideEnableExportAddressFilterPlus="false" OverrideEnableImportAddressFilter="false" OverrideEnableRopStackPivot="false" OverrideEnableRopCallerCheck="false" OverrideEnableRopSimExec="false" />
  </AppConfig>
  <AppConfig Executable="OIS.EXE">
    <DEP OverrideDEP="false" />
    <Payload OverrideEnableExportAddressFilter="false" OverrideEnableExportAddressFilterPlus="false" OverrideEnableImportAddressFilter="false" OverrideEnableRopStackPivot="false" OverrideEnableRopCallerCheck="false" OverrideEnableRopSimExec="false" />
  </AppConfig>
  <AppConfig Executable="OUTLOOK.EXE">
    <DEP OverrideDEP="false" />
    <ASLR ForceRelocateImages="true" />
    <Payload OverrideEnableExportAddressFilter="false" OverrideEnableExportAddressFilterPlus="false" OverrideEnableImportAddressFilter="false" OverrideEnableRopStackPivot="false" OverrideEnableRopCallerCheck="false" OverrideEnableRopSimExec="false" />
  </AppConfig>
  <AppConfig Executable="plugin-container.exe">
    <DEP OverrideDEP="false" />
    <Payload OverrideEnableExportAddressFilter="false" OverrideEnableExportAddressFilterPlus="false" OverrideEnableImportAddressFilter="false" OverrideEnableRopStackPivot="false" OverrideEnableRopCallerCheck="false" OverrideEnableRopSimExec="false" />
  </AppConfig>
  <AppConfig Executable="POWERPNT.EXE">
    <DEP OverrideDEP="false" />
    <ASLR ForceRelocateImages="true" />
    <Payload OverrideEnableExportAddressFilter="false" OverrideEnableExportAddressFilterPlus="false" OverrideEnableImportAddressFilter="false" OverrideEnableRopStackPivot="false" OverrideEnableRopCallerCheck="false" OverrideEnableRopSimExec="false" />
  </AppConfig>
  <AppConfig Executable="PPTVIEW.EXE">
    <DEP OverrideDEP="false" />
    <ASLR ForceRelocateImages="true" />
    <Payload OverrideEnableExportAddressFilter="false" OverrideEnableExportAddressFilterPlus="false" OverrideEnableImportAddressFilter="false" OverrideEnableRopStackPivot="false" OverrideEnableRopCallerCheck="false" OverrideEnableRopSimExec="false" />
  </AppConfig>
  <AppConfig Executable="VISIO.EXE">
    <DEP OverrideDEP="false" />
    <ASLR ForceRelocateImages="true" />
    <Payload OverrideEnableExportAddressFilter="false" OverrideEnableExportAddressFilterPlus="false" OverrideEnableImportAddressFilter="false" OverrideEnableRopStackPivot="false" OverrideEnableRopCallerCheck="false" OverrideEnableRopSimExec="false" />
  </AppConfig>
  <AppConfig Executable="VPREVIEW.EXE">
    <DEP OverrideDEP="false" />
    <ASLR ForceRelocateImages="true" />
    <Payload OverrideEnableExportAddressFilter="false" OverrideEnableExportAddressFilterPlus="false" OverrideEnableImportAddressFilter="false" OverrideEnableRopStackPivot="false" OverrideEnableRopCallerCheck="false" OverrideEnableRopSimExec="false" />
  </AppConfig>
  <AppConfig Executable="WINWORD.EXE">
    <DEP OverrideDEP="false" />
    <ASLR ForceRelocateImages="true" />
    <Payload OverrideEnableExportAddressFilter="false" OverrideEnableExportAddressFilterPlus="false" OverrideEnableImportAddressFilter="false" OverrideEnableRopStackPivot="false" OverrideEnableRopCallerCheck="false" OverrideEnableRopSimExec="false" />
  </AppConfig>
  <AppConfig Executable="wmplayer.exe">
    <DEP OverrideDEP="false" />
    <Payload OverrideEnableExportAddressFilter="false" OverrideEnableExportAddressFilterPlus="false" OverrideEnableImportAddressFilter="false" OverrideEnableRopStackPivot="false" OverrideEnableRopCallerCheck="false" OverrideEnableRopSimExec="false" />
  </AppConfig>
  <AppConfig Executable="wordpad.exe">
    <DEP OverrideDEP="false" />
    <Payload OverrideEnableExportAddressFilter="false" OverrideEnableExportAddressFilterPlus="false" OverrideEnableImportAddressFilter="false" OverrideEnableRopStackPivot="false" OverrideEnableRopCallerCheck="false" OverrideEnableRopSimExec="false" />
  </AppConfig>
</MitigationPolicy>
```

## <a name="mitigation-reference"></a><span data-ttu-id="a89c2-125">Referência de mitigação</span><span class="sxs-lookup"><span data-stu-id="a89c2-125">Mitigation Reference</span></span>

<span data-ttu-id="a89c2-126">As seções a seguir detalham as proteções fornecidas por cada mitigação de proteção de exploração, as considerações de compatibilidade para a mitigação e as opções de configuração disponíveis.</span><span class="sxs-lookup"><span data-stu-id="a89c2-126">The following sections detail the protections provided by each exploit protection mitigation, the compatibility considerations for the mitigation, and the configuration options available.</span></span>

## <a name="arbitrary-code-guard"></a><span data-ttu-id="a89c2-127">Proteção de código arbitrário</span><span class="sxs-lookup"><span data-stu-id="a89c2-127">Arbitrary code guard</span></span>

### <a name="description"></a><span data-ttu-id="a89c2-128">Descrição</span><span class="sxs-lookup"><span data-stu-id="a89c2-128">Description</span></span>

<span data-ttu-id="a89c2-129">O proteção de código arbitrário ajuda a proteger contra um invasor mal-intencionado carregando o código de sua escolha na memória por meio de uma vulnerabilidade de segurança de memória e podendo executar esse código.</span><span class="sxs-lookup"><span data-stu-id="a89c2-129">Arbitrary code guard helps protect against a malicious attacker loading the code of their choice into memory through a memory safety vulnerability and being able to execute that code.</span></span>

<span data-ttu-id="a89c2-130">O proteção de código arbitrário protege um aplicativo contra a execução de código gerado dinamicamente (código que não é carregado, por exemplo, do exe em si ou de uma dll).</span><span class="sxs-lookup"><span data-stu-id="a89c2-130">Arbitrary code guard protects an application from executing dynamically generated code (code that is not loaded, for example, from the exe itself or a dll).</span></span> <span data-ttu-id="a89c2-131">O code guard arbitrário funciona impedindo que a memória seja marcada como executável.</span><span class="sxs-lookup"><span data-stu-id="a89c2-131">Arbitrary code guard works by preventing memory from being marked as executable.</span></span> <span data-ttu-id="a89c2-132">Quando um aplicativo tenta [alocar memória,](https://docs.microsoft.com/windows/win32/api/memoryapi/nf-memoryapi-virtualalloc)verificamos os sinalizadores de proteção.</span><span class="sxs-lookup"><span data-stu-id="a89c2-132">When an application attempts to [allocate memory](https://docs.microsoft.com/windows/win32/api/memoryapi/nf-memoryapi-virtualalloc), we check the protection flags.</span></span> <span data-ttu-id="a89c2-133">(A memória pode ser alocada com sinalizadores de proteção de leitura, gravação e/ou execução.) Se a alocação tentar incluir o sinalizador de proteção [*de*](https://docs.microsoft.com/windows/win32/memory/memory-protection-constants) execução, a alocação de memória falhará e retornará um código de erro (STATUS_DYNAMIC_CODE_BLOCKED).</span><span class="sxs-lookup"><span data-stu-id="a89c2-133">(Memory can be allocated with read, write, and/or execute protection flags.) If the allocation attempts to include the [*execute*](https://docs.microsoft.com/windows/win32/memory/memory-protection-constants) protection flag, then the memory allocation fails and returns an error code (STATUS_DYNAMIC_CODE_BLOCKED).</span></span> <span data-ttu-id="a89c2-134">Da mesma forma, se [](https://docs.microsoft.com/windows/win32/api/memoryapi/nf-memoryapi-virtualprotect) um aplicativo tentar alterar os sinalizadores de proteção [](https://docs.microsoft.com/windows/win32/memory/memory-protection-constants) da memória que já foram alocados e inclui o sinalizador de proteção de execução, a alteração de permissão falhará e retornará um código de erro (STATUS_DYNAMIC_CODE_BLOCKED).</span><span class="sxs-lookup"><span data-stu-id="a89c2-134">Similarly, if an application attempts to [change the protection flags of memory](https://docs.microsoft.com/windows/win32/api/memoryapi/nf-memoryapi-virtualprotect) that has already been allocated and includes the [*execute*](https://docs.microsoft.com/windows/win32/memory/memory-protection-constants) protection flag, then the permission change fails and returns an error code (STATUS_DYNAMIC_CODE_BLOCKED).</span></span>

<span data-ttu-id="a89c2-135">Ao impedir que o sinalizador *de* execução seja definido, o recurso de prevenção de execução de dados do Windows 10 pode, em seguida, proteger contra o ponteiro de instrução que está sendo definido para essa memória e executar esse código.</span><span class="sxs-lookup"><span data-stu-id="a89c2-135">By preventing the *execute* flag from being set, the data execution prevention feature of Windows 10 can then protect against the instruction pointer being set to that memory and running that code.</span></span>

### <a name="compatibility-considerations"></a><span data-ttu-id="a89c2-136">Considerações sobre compatibilidade</span><span class="sxs-lookup"><span data-stu-id="a89c2-136">Compatibility considerations</span></span>

<span data-ttu-id="a89c2-137">O code guard arbitrário impede a alocação de qualquer memória como executável, o que apresenta um problema de compatibilidade com abordagens como compiladores just-in-time (JIT).</span><span class="sxs-lookup"><span data-stu-id="a89c2-137">Arbitrary code guard prevents allocating any memory as executable, which presents a compatibility issue with approaches such as Just-in-Time (JIT) compilers.</span></span> <span data-ttu-id="a89c2-138">A maioria dos navegadores modernos, por exemplo, compila JavaScript em código nativo para otimizar o desempenho.</span><span class="sxs-lookup"><span data-stu-id="a89c2-138">Most modern browsers, for example, will compile JavaScript into native code in order to optimize performance.</span></span> <span data-ttu-id="a89c2-139">Para dar suporte a essa mitigação, eles precisarão ser rearmados para mover a compilação JIT para fora do processo protegido.</span><span class="sxs-lookup"><span data-stu-id="a89c2-139">In order to support this mitigation, they will need to be rearchitected to move the JIT compilation outside of the protected process.</span></span> <span data-ttu-id="a89c2-140">Outros aplicativos cujo design gera dinamicamente código a partir de scripts ou outros idiomas intermediários serão incompatíveis com essa mitigação.</span><span class="sxs-lookup"><span data-stu-id="a89c2-140">Other applications whose design dynamically generates code from scripts or other intermediate languages will be similarly incompatible with this mitigation.</span></span>

### <a name="configuration-options"></a><span data-ttu-id="a89c2-141">Opções de configuração</span><span class="sxs-lookup"><span data-stu-id="a89c2-141">Configuration options</span></span>

<span data-ttu-id="a89c2-142">**Permitir a aceitação de threads** - Você pode configurar a mitigação para permitir que um thread individual opte por essa proteção.</span><span class="sxs-lookup"><span data-stu-id="a89c2-142">**Allow thread opt-out** - You can configure the mitigation to allow an individual thread to opt-out of this protection.</span></span> <span data-ttu-id="a89c2-143">O desenvolvedor deve ter escrito o aplicativo com reconhecimento dessa mitigação e ter chamado a API [**SetThreadInformation**](https://docs.microsoft.com/windows/win32/api/processthreadsapi/nf-processthreadsapi-setthreadinformation) com o parâmetro *ThreadInformation* definido como **ThreadDynamicCodePolicy** para poder executar o código dinâmico neste thread.</span><span class="sxs-lookup"><span data-stu-id="a89c2-143">The developer must have written the application with awareness of this mitigation, and have called the [**SetThreadInformation**](https://docs.microsoft.com/windows/win32/api/processthreadsapi/nf-processthreadsapi-setthreadinformation) API with the *ThreadInformation* parameter set to **ThreadDynamicCodePolicy** in order to be allowed to execute dynamic code on this thread.</span></span>

<span data-ttu-id="a89c2-144">**Somente auditoria** - Você pode habilitar essa mitigação no modo de auditoria para medir o impacto potencial da compatibilidade em um aplicativo.</span><span class="sxs-lookup"><span data-stu-id="a89c2-144">**Audit only** - You can enable this mitigation in audit mode in order to measure the potential compatibility impact on an application.</span></span> <span data-ttu-id="a89c2-145">Os eventos de auditoria podem ser exibidos no visualizador de eventos ou usando a Busca Avançada no [Defender para o Ponto de Extremidade.](https://docs.microsoft.com/microsoft-365/security/defender/advanced-hunting-overview)</span><span class="sxs-lookup"><span data-stu-id="a89c2-145">Audit events can then be viewed either in the event viewer or using Advanced Hunting in [Defender for Endpoint](https://docs.microsoft.com/microsoft-365/security/defender/advanced-hunting-overview).</span></span>

## <a name="block-low-integrity-images"></a><span data-ttu-id="a89c2-146">Bloquear imagens de baixa integridade</span><span class="sxs-lookup"><span data-stu-id="a89c2-146">Block low integrity images</span></span>

### <a name="description"></a><span data-ttu-id="a89c2-147">Descrição</span><span class="sxs-lookup"><span data-stu-id="a89c2-147">Description</span></span>

<span data-ttu-id="a89c2-148">Bloquear imagens de baixa integridade impede que o aplicativo carregue arquivos que não sejam de confiança, normalmente porque eles foram baixados da Internet de um navegador em áreas de segurança.</span><span class="sxs-lookup"><span data-stu-id="a89c2-148">Block low integrity images prevents the application from loading files that are untrusted, typically because they have been downloaded from the internet from a sandboxed browser.</span></span>

<span data-ttu-id="a89c2-149">Essa mitigação bloqueará as cargas de imagem se a imagem tiver uma Ace (Entrada de Controle de Acesso) que conceda acesso a processos de Baixa IL e que não tenha um ACE de rótulo de confiança.</span><span class="sxs-lookup"><span data-stu-id="a89c2-149">This mitigation will block image loads if the image has an Access Control Entry (ACE) which grants access to Low IL processes and which does not have a trust label ACE.</span></span> <span data-ttu-id="a89c2-150">Ele é implementado pelo gerenciador de memória, que impede que o arquivo seja mapeado na memória.</span><span class="sxs-lookup"><span data-stu-id="a89c2-150">It is implemented by the memory manager, which blocks the file from being mapped into memory.</span></span> <span data-ttu-id="a89c2-151">Se um aplicativo tentar mapear uma imagem de baixa integridade, ele disparará um STATUS_ACCESS_DENIED erro.</span><span class="sxs-lookup"><span data-stu-id="a89c2-151">If an application attempts to map a low integrity image, it will trigger a STATUS_ACCESS_DENIED error.</span></span> <span data-ttu-id="a89c2-152">Para obter detalhes sobre como funcionam os níveis de integridade, consulte [Controle obrigatório de integridade.](https://docs.microsoft.com/windows/win32/secauthz/mandatory-integrity-control)</span><span class="sxs-lookup"><span data-stu-id="a89c2-152">For details on how integrity levels work, see [Mandatory Integrity Control](https://docs.microsoft.com/windows/win32/secauthz/mandatory-integrity-control).</span></span>

### <a name="compatibility-considerations"></a><span data-ttu-id="a89c2-153">Considerações sobre compatibilidade</span><span class="sxs-lookup"><span data-stu-id="a89c2-153">Compatibility considerations</span></span>

<span data-ttu-id="a89c2-154">Bloquear imagens de baixa integridade impedirá que o aplicativo carregue arquivos baixados da Internet.</span><span class="sxs-lookup"><span data-stu-id="a89c2-154">Block low integrity images will prevent the application from loading files that were downloaded from the internet.</span></span> <span data-ttu-id="a89c2-155">Se o fluxo de trabalho do aplicativo exigir o carregamento de imagens baixadas, você vai querer garantir que elas sejam baixadas de um processo de confiança mais alta ou sejam explicitamente rotuladas para aplicar essa mitigação.</span><span class="sxs-lookup"><span data-stu-id="a89c2-155">If your application workflow requires loading images that are downloaded, you will want to ensure that they are downloaded from a higher-trust process, or are explicitly relabeled in order to apply this mitigation.</span></span>

### <a name="configuration-options"></a><span data-ttu-id="a89c2-156">Opções de configuração</span><span class="sxs-lookup"><span data-stu-id="a89c2-156">Configuration options</span></span>

<span data-ttu-id="a89c2-157">**Somente auditoria** - Você pode habilitar essa mitigação no modo de auditoria para medir o impacto potencial da compatibilidade em um aplicativo.</span><span class="sxs-lookup"><span data-stu-id="a89c2-157">**Audit Only** - You can enable this mitigation in audit mode in order to measure the potential compatibility impact on an application.</span></span> <span data-ttu-id="a89c2-158">Os eventos de auditoria podem ser exibidos no visualizador de eventos ou usando a Busca Avançada no [Microsoft Defender para Ponto de Extremidade.](https://docs.microsoft.com/microsoft-365/security/defender/advanced-hunting-overview)</span><span class="sxs-lookup"><span data-stu-id="a89c2-158">Audit events can then be viewed either in the event viewer or using Advanced Hunting in [Microsoft Defender for Endpoint](https://docs.microsoft.com/microsoft-365/security/defender/advanced-hunting-overview).</span></span>

## <a name="block-remote-images"></a><span data-ttu-id="a89c2-159">Bloquear imagens remotas</span><span class="sxs-lookup"><span data-stu-id="a89c2-159">Block remote images</span></span>

### <a name="description"></a><span data-ttu-id="a89c2-160">Descrição</span><span class="sxs-lookup"><span data-stu-id="a89c2-160">Description</span></span>

<span data-ttu-id="a89c2-161">O bloqueio de imagens remotas ajuda a impedir que o aplicativo carrega arquivos hospedados em um dispositivo remoto, como um compartilhamento UNC.</span><span class="sxs-lookup"><span data-stu-id="a89c2-161">Blocking remote images helps to prevent the application from loading files that are hosted on a remote device, such as a UNC share.</span></span> <span data-ttu-id="a89c2-162">O bloqueio de imagens remotas ajuda a proteger contra carregar binários na memória que estão em um dispositivo externo controlado pelo invasor.</span><span class="sxs-lookup"><span data-stu-id="a89c2-162">Blocking remote images helps protect against loading binaries into memory that are on an external device controlled by the attacker.</span></span>

<span data-ttu-id="a89c2-163">Essa mitigação bloqueará cargas de imagem se a imagem for determinada em um dispositivo remoto.</span><span class="sxs-lookup"><span data-stu-id="a89c2-163">This mitigation will block image loads if the image is determined to be on a remote device.</span></span> <span data-ttu-id="a89c2-164">Ele é implementado pelo gerenciador de memória, que impede que o arquivo seja mapeado na memória.</span><span class="sxs-lookup"><span data-stu-id="a89c2-164">It is implemented by the memory manager, which blocks the file from being mapped into memory.</span></span> <span data-ttu-id="a89c2-165">Se um aplicativo tentar mapear um arquivo remoto, ele disparará um STATUS_ACCESS_DENIED erro.</span><span class="sxs-lookup"><span data-stu-id="a89c2-165">If an application attempts to map a remote file, it will trigger a STATUS_ACCESS_DENIED error.</span></span>

### <a name="compatibility-considerations"></a><span data-ttu-id="a89c2-166">Considerações sobre compatibilidade</span><span class="sxs-lookup"><span data-stu-id="a89c2-166">Compatibility considerations</span></span>

<span data-ttu-id="a89c2-167">Bloquear imagens remotas impedirá que o aplicativo carrega imagens de dispositivos remotos.</span><span class="sxs-lookup"><span data-stu-id="a89c2-167">Block remote images will prevent the application from loading images from remote devices.</span></span> <span data-ttu-id="a89c2-168">Se o aplicativo carregar arquivos ou plug-ins de dispositivos remotos, ele não será compatível com essa mitigação.</span><span class="sxs-lookup"><span data-stu-id="a89c2-168">If your application loads files or plug-ins from remote devices, then it will not be compatible with this mitigation.</span></span>

### <a name="configuration-options"></a><span data-ttu-id="a89c2-169">Opções de configuração</span><span class="sxs-lookup"><span data-stu-id="a89c2-169">Configuration options</span></span>

<span data-ttu-id="a89c2-170">**Somente auditoria** - Você pode habilitar essa mitigação no modo de auditoria para medir o impacto potencial da compatibilidade em um aplicativo.</span><span class="sxs-lookup"><span data-stu-id="a89c2-170">**Audit Only** - You can enable this mitigation in audit mode in order to measure the potential compatibility impact on an application.</span></span> <span data-ttu-id="a89c2-171">Os eventos de auditoria podem ser exibidos no visualizador de eventos ou usando a Busca Avançada no [Microsoft Defender para Ponto de Extremidade.](https://docs.microsoft.com/microsoft-365/security/defender/advanced-hunting-overview)</span><span class="sxs-lookup"><span data-stu-id="a89c2-171">Audit events can then be viewed either in the event viewer or using Advanced Hunting in [Microsoft Defender for Endpoint](https://docs.microsoft.com/microsoft-365/security/defender/advanced-hunting-overview).</span></span>

## <a name="block-untrusted-fonts"></a><span data-ttu-id="a89c2-172">Bloquear fontes não confianças</span><span class="sxs-lookup"><span data-stu-id="a89c2-172">Block untrusted fonts</span></span>

### <a name="description"></a><span data-ttu-id="a89c2-173">Descrição</span><span class="sxs-lookup"><span data-stu-id="a89c2-173">Description</span></span>

<span data-ttu-id="a89c2-174">O bloqueio de fontes nãotrudas reduz o risco de uma falha na análise de fonte que leva o invasor a executar código no dispositivo.</span><span class="sxs-lookup"><span data-stu-id="a89c2-174">Block untrusted fonts mitigates the risk of a flaw in font parsing leading to the attacker being able to run code on the device.</span></span> <span data-ttu-id="a89c2-175">Somente fontes instaladas no diretório windows\fonts serão carregadas para processamento pela GDI.</span><span class="sxs-lookup"><span data-stu-id="a89c2-175">Only fonts that are installed into the windows\fonts directory will be loaded for processing by GDI.</span></span>

<span data-ttu-id="a89c2-176">Essa mitigação é implementada no GDI, que valida o local do arquivo.</span><span class="sxs-lookup"><span data-stu-id="a89c2-176">This mitigation is implemented within GDI, which validates the location of the file.</span></span> <span data-ttu-id="a89c2-177">Se o arquivo não estiver no diretório de fontes do sistema, a fonte não será carregada para análise e essa chamada falhará.</span><span class="sxs-lookup"><span data-stu-id="a89c2-177">If the file is not in the system fonts directory, the font will not be loaded for parsing and that call will fail.</span></span>

<span data-ttu-id="a89c2-178">Essa mitigação é além da mitigação interna fornecida no Windows 10 1607 e posterior, que move a análise de fonte para fora do kernel e para um contêiner de aplicativo no modo de usuário.</span><span class="sxs-lookup"><span data-stu-id="a89c2-178">This mitigation is in addition to the built-in mitigation provided in Windows 10 1607 and later, which moves font parsing out of the kernel and into a user-mode app container.</span></span> <span data-ttu-id="a89c2-179">Qualquer exploração baseada na análise de fonte, como resultado, acontece em um contexto isolado e em áreas de áreas de risco, o que reduz significativamente o risco.</span><span class="sxs-lookup"><span data-stu-id="a89c2-179">Any exploit based on font parsing, as a result, happens in a sandboxed and isolated context, which reduces the risk significantly.</span></span> <span data-ttu-id="a89c2-180">Para obter detalhes sobre essa mitigação, consulte o blog [Hardening Windows 10 with zero-day exploit mitigations](https://www.microsoft.com/security/blog/2017/01/13/hardening-windows-10-with-zero-day-exploit-mitigations/).</span><span class="sxs-lookup"><span data-stu-id="a89c2-180">For details on this mitigation, see the blog [Hardening Windows 10 with zero-day exploit mitigations](https://www.microsoft.com/security/blog/2017/01/13/hardening-windows-10-with-zero-day-exploit-mitigations/).</span></span>

### <a name="compatibility-considerations"></a><span data-ttu-id="a89c2-181">Considerações sobre compatibilidade</span><span class="sxs-lookup"><span data-stu-id="a89c2-181">Compatibility considerations</span></span>

<span data-ttu-id="a89c2-182">O uso mais comum de fontes fora do diretório de fontes do sistema é com [fontes da Web](https://docs.microsoft.com/typography/fonts/font-faq#web).</span><span class="sxs-lookup"><span data-stu-id="a89c2-182">The most common use of fonts outside of the system fonts directory is with [web fonts](https://docs.microsoft.com/typography/fonts/font-faq#web).</span></span> <span data-ttu-id="a89c2-183">Os navegadores modernos, como o Microsoft Edge, usam DirectWrite em vez de GDI e não são afetados.</span><span class="sxs-lookup"><span data-stu-id="a89c2-183">Modern browsers, such as Microsoft Edge, use DirectWrite instead of GDI, and are not impacted.</span></span> <span data-ttu-id="a89c2-184">No entanto, navegadores herdados, como o Internet Explorer 11 (e o modo IE no novo Microsoft Edge) podem ser afetados, especialmente com aplicativos como o Office 365, que usam glifos de fonte para exibir a interface do usuário.</span><span class="sxs-lookup"><span data-stu-id="a89c2-184">However, legacy browsers, such as Internet Explorer 11 (and IE mode in the new Microsoft Edge) can be impacted, particularly with applications such as Office 365, which use font glyphs to display UI.</span></span>

### <a name="configuration-options"></a><span data-ttu-id="a89c2-185">Opções de configuração</span><span class="sxs-lookup"><span data-stu-id="a89c2-185">Configuration options</span></span>

<span data-ttu-id="a89c2-186">**Somente auditoria** - Você pode habilitar essa mitigação no modo de auditoria para medir o impacto potencial da compatibilidade em um aplicativo.</span><span class="sxs-lookup"><span data-stu-id="a89c2-186">**Audit Only** - You can enable this mitigation in audit mode in order to measure the potential compatibility impact on an application.</span></span> <span data-ttu-id="a89c2-187">Os eventos de auditoria podem ser exibidos no visualizador de eventos ou usando a Busca Avançada no [Microsoft Defender para Ponto de Extremidade.](https://docs.microsoft.com/microsoft-365/security/defender/advanced-hunting-overview)</span><span class="sxs-lookup"><span data-stu-id="a89c2-187">Audit events can then be viewed either in the event viewer or using Advanced Hunting in [Microsoft Defender for Endpoint](https://docs.microsoft.com/microsoft-365/security/defender/advanced-hunting-overview).</span></span>

## <a name="code-integrity-guard"></a><span data-ttu-id="a89c2-188">Proteção de integridade de código</span><span class="sxs-lookup"><span data-stu-id="a89c2-188">Code integrity guard</span></span>

### <a name="description"></a><span data-ttu-id="a89c2-189">Descrição</span><span class="sxs-lookup"><span data-stu-id="a89c2-189">Description</span></span>

<span data-ttu-id="a89c2-190">O Code integrity guard garante que todos os binários carregados em um processo sejam assinados digitalmente pela Microsoft.</span><span class="sxs-lookup"><span data-stu-id="a89c2-190">Code integrity guard ensures that all binaries loaded into a process are digitally signed by Microsoft.</span></span> <span data-ttu-id="a89c2-191">O Code integrity guard inclui [assinaturas WHQL](https://docs.microsoft.com/windows-hardware/drivers/install/whql-release-signature) (Laboratórios de Qualidade de Hardware do Windows), o que permitirá que drivers aprovados pelo WHQL executem dentro do processo.</span><span class="sxs-lookup"><span data-stu-id="a89c2-191">Code integrity guard includes [WHQL](https://docs.microsoft.com/windows-hardware/drivers/install/whql-release-signature) (Windows Hardware Quality Labs) signatures, which will allow WHQL-approved drivers to run within the process.</span></span>

<span data-ttu-id="a89c2-192">Essa mitigação é implementada no gerenciador de memória, o que impede que o binário seja mapeado na memória.</span><span class="sxs-lookup"><span data-stu-id="a89c2-192">This mitigation is implemented within the memory manager, which blocks the binary from being mapped into memory.</span></span> <span data-ttu-id="a89c2-193">Se você tentar carregar um binário não assinado pela Microsoft, o manger de memória retornará o erro STATUS_INVALID_IMAGE_HASH.</span><span class="sxs-lookup"><span data-stu-id="a89c2-193">If you attempt to load a binary that is not signed by Microsoft, the memory manger will return the error STATUS_INVALID_IMAGE_HASH.</span></span> <span data-ttu-id="a89c2-194">Ao bloquear no nível do gerenciador de memória, isso impede que binários carregados pelo processo e binários injetados no processo.</span><span class="sxs-lookup"><span data-stu-id="a89c2-194">By blocking at the memory manager level, this prevents both binaries loaded by the process and binaries injected into the process.</span></span>

### <a name="compatibility-considerations"></a><span data-ttu-id="a89c2-195">Considerações sobre compatibilidade</span><span class="sxs-lookup"><span data-stu-id="a89c2-195">Compatibility considerations</span></span>

<span data-ttu-id="a89c2-196">Essa mitigação bloqueia especificamente qualquer binário que não seja assinado pela Microsoft.</span><span class="sxs-lookup"><span data-stu-id="a89c2-196">This mitigation specifically blocks any binary that is not signed by Microsoft.</span></span> <span data-ttu-id="a89c2-197">Dessa forma, ele será incompatível com a maioria dos softwares de terceiros, a menos que esse software seja distribuído pela Microsoft Store (e assinado digitalmente) pela Microsoft Store e a opção de permitir o carregamento de imagens assinadas pela Microsoft Store esteja selecionada.</span><span class="sxs-lookup"><span data-stu-id="a89c2-197">As such, it will be incompatible with most third-party software, unless that software is distributed by (and digitally signed by) the Microsoft Store, and the option to allow loading of images signed by the Microsoft Store is selected.</span></span>

### <a name="configuration-options"></a><span data-ttu-id="a89c2-198">Opções de configuração</span><span class="sxs-lookup"><span data-stu-id="a89c2-198">Configuration options</span></span>

<span data-ttu-id="a89c2-199">Também permitir o carregamento de imagens assinadas pela **Microsoft Store** - Os aplicativos distribuídos pela Microsoft Store serão assinados digitalmente pela Microsoft Store e adicionar essa configuração permitirá que binários que passaram pelo processo de certificação da loja sejam carregados pelo aplicativo.</span><span class="sxs-lookup"><span data-stu-id="a89c2-199">**Also allow loading of images signed by Microsoft Store** - Applications that are distributed by the Microsoft Store will be digitally signed by the Microsoft Store, and adding this configuration will allow binaries that have gone through the store certification process to be loaded by the application.</span></span>

<span data-ttu-id="a89c2-200">**Somente auditoria** - Você pode habilitar essa mitigação no modo de auditoria para medir o impacto potencial da compatibilidade em um aplicativo.</span><span class="sxs-lookup"><span data-stu-id="a89c2-200">**Audit Only** - You can enable this mitigation in audit mode in order to measure the potential compatibility impact on an application.</span></span> <span data-ttu-id="a89c2-201">Os eventos de auditoria podem ser exibidos no visualizador de eventos ou usando a Busca Avançada no [Microsoft Defender para Ponto de Extremidade.](https://docs.microsoft.com/microsoft-365/security/defender/advanced-hunting-overview)</span><span class="sxs-lookup"><span data-stu-id="a89c2-201">Audit events can then be viewed either in the event viewer or using Advanced Hunting in [Microsoft Defender for Endpoint](https://docs.microsoft.com/microsoft-365/security/defender/advanced-hunting-overview).</span></span>

## <a name="control-flow-guard-cfg"></a><span data-ttu-id="a89c2-202">Proteção de fluxo de controle (CFG)</span><span class="sxs-lookup"><span data-stu-id="a89c2-202">Control flow guard (CFG)</span></span>

### <a name="description"></a><span data-ttu-id="a89c2-203">Descrição</span><span class="sxs-lookup"><span data-stu-id="a89c2-203">Description</span></span>

<span data-ttu-id="a89c2-204">O CfG reduz o risco de invasores usarem vulnerabilidades de corrupção de memória protegendo chamadas de função indireta.</span><span class="sxs-lookup"><span data-stu-id="a89c2-204">Control flow guard (CFG) mitigates the risk of attackers using memory corruption vulnerabilities by protecting indirect function calls.</span></span> <span data-ttu-id="a89c2-205">Por exemplo, um invasor pode usuária de uma vulnerabilidade de estouro de buffer para substituir a memória que contém um ponteiro de função e substituir esse ponteiro de função por um ponteiro para o código executável de sua escolha (que também pode ter sido injetado no programa).</span><span class="sxs-lookup"><span data-stu-id="a89c2-205">For example, an attacker may user a buffer overflow vulnerability to overwrite memory containing a function pointer, and replace that function pointer with a pointer to executable code of their choice (which may also have been injected into the program).</span></span>

<span data-ttu-id="a89c2-206">Essa mitigação é fornecida injetando outra verificação no momento da compilação.</span><span class="sxs-lookup"><span data-stu-id="a89c2-206">This mitigation is provided by injecting another check at compile time.</span></span> <span data-ttu-id="a89c2-207">Antes de cada chamada de função indireta, outras instruções são adicionadas que verificam se o destino é um destino de chamada válido antes de ser chamado.</span><span class="sxs-lookup"><span data-stu-id="a89c2-207">Before each indirect function call, another instructions are added which verify that the target is a valid call target before it is called.</span></span> <span data-ttu-id="a89c2-208">Se o destino não for um destino de chamada válido, o aplicativo será encerrado.</span><span class="sxs-lookup"><span data-stu-id="a89c2-208">If the target is not a valid call target, then the application is terminated.</span></span> <span data-ttu-id="a89c2-209">Dessa forma, somente aplicativos compilados com suporte a CFG podem se beneficiar dessa mitigação.</span><span class="sxs-lookup"><span data-stu-id="a89c2-209">As such, only applications that are compiled with CFG support can benefit from this mitigation.</span></span>

<span data-ttu-id="a89c2-210">A verificação de um destino válido é fornecida pelo kernel do Windows.</span><span class="sxs-lookup"><span data-stu-id="a89c2-210">The check for a valid target is provided by the Windows kernel.</span></span> <span data-ttu-id="a89c2-211">Quando os arquivos executáveis são carregados, os metadados para destinos de chamada indireta são extraídos no tempo de carregamento e marcados como destinos de chamada válidos.</span><span class="sxs-lookup"><span data-stu-id="a89c2-211">When executable files are loaded, the metadata for indirect call targets is extracted at load time and marked as valid call targets.</span></span> <span data-ttu-id="a89c2-212">Além disso, quando a memória é alocada e marcada como executável (como para código gerado), esses locais de memória também são marcados como destinos de chamada válidos, para dar suporte a mecanismos como compilação JIT.</span><span class="sxs-lookup"><span data-stu-id="a89c2-212">Additionally, when memory is allocated and marked as executable (such as for generated code), these memory locations are also marked as valid call targets, to support mechanisms such as JIT compilation.</span></span>

### <a name="compatibility-considerations"></a><span data-ttu-id="a89c2-213">Considerações sobre compatibilidade</span><span class="sxs-lookup"><span data-stu-id="a89c2-213">Compatibility considerations</span></span>

<span data-ttu-id="a89c2-214">Como os aplicativos devem ser compilados para dar suporte ao CFG, eles declaram implicitamente sua compatibilidade com ele.</span><span class="sxs-lookup"><span data-stu-id="a89c2-214">Since applications must be compiled to support CFG, they implicitly declare their compatibility with it.</span></span> <span data-ttu-id="a89c2-215">A maioria dos aplicativos, portanto, deve trabalhar com essa mitigação habilitada.</span><span class="sxs-lookup"><span data-stu-id="a89c2-215">Most applications, therefore, should work with this mitigation enabled.</span></span> <span data-ttu-id="a89c2-216">Como essas verificações são compiladas no binário, a configuração que você pode aplicar é simplesmente desabilitar verificações no kernel do Windows.</span><span class="sxs-lookup"><span data-stu-id="a89c2-216">Because these checks are compiled into the binary, the configuration you can apply is merely to disable checks within the Windows kernel.</span></span> <span data-ttu-id="a89c2-217">Em outras palavras, a mitigação está em ação por padrão, mas você pode configurar o kernel do Windows para sempre retornar "sim" se você determinar posteriormente que há um problema de compatibilidade que o desenvolvedor de aplicativos não descobriu em seus testes, o que deve ser raro.</span><span class="sxs-lookup"><span data-stu-id="a89c2-217">In other words, the mitigation is on by default, but you can configure the Windows kernel to always return "yes" if you later determine that there is a compatibility issue that the application developer did not discover in their testing, which should be rare.</span></span>

### <a name="configuration-options"></a><span data-ttu-id="a89c2-218">Opções de configuração</span><span class="sxs-lookup"><span data-stu-id="a89c2-218">Configuration options</span></span>

<span data-ttu-id="a89c2-219">**Use CFG** estrito - No modo estrito, todos os binários carregados no processo devem ser compilados para o Control Flow Guard (ou não têm nenhum código executável neles - como dlls de recursos) para serem carregados.</span><span class="sxs-lookup"><span data-stu-id="a89c2-219">**Use strict CFG** - In strict mode, all binaries loaded into the process must be compiled for Control Flow Guard (or have no executable code in them - such as resource dlls) in order to be loaded.</span></span>

> [!Note]
> <span data-ttu-id="a89c2-220">**O control flow guard** não tem modo de auditoria.</span><span class="sxs-lookup"><span data-stu-id="a89c2-220">**Control flow guard** has no audit mode.</span></span> <span data-ttu-id="a89c2-221">Binários são compilados com essa mitigação habilitada.</span><span class="sxs-lookup"><span data-stu-id="a89c2-221">Binaries are compiled with this mitigation enabled.</span></span>

## <a name="data-execution-prevention-dep"></a><span data-ttu-id="a89c2-222">Prevenção de Execução de Dados (DEP)</span><span class="sxs-lookup"><span data-stu-id="a89c2-222">Data Execution Prevention (DEP)</span></span>

### <a name="description"></a><span data-ttu-id="a89c2-223">Descrição</span><span class="sxs-lookup"><span data-stu-id="a89c2-223">Description</span></span>

<span data-ttu-id="a89c2-224">A PREVENÇÃO de execução de dados (DEP) impede que a memória que não foi alocada explicitamente como executável seja executada.</span><span class="sxs-lookup"><span data-stu-id="a89c2-224">Data execution prevention (DEP) prevents memory that was not explicitly allocated as executable from being executed.</span></span> <span data-ttu-id="a89c2-225">A DEP ajuda a proteger contra um invasor que injeta código mal-intencionado no processo, como por meio de um estouro de buffer e, em seguida, executando esse código.</span><span class="sxs-lookup"><span data-stu-id="a89c2-225">DEP helps protect against an attacker injecting malicious code into the process, such as through a buffer overflow, and then executing that code.</span></span>

<span data-ttu-id="a89c2-226">Se você tentar definir o ponteiro de instrução para um endereço de memória não marcado como executável, o processador lançará uma exceção (violação de proteção geral), fazendo com que o aplicativo falha.</span><span class="sxs-lookup"><span data-stu-id="a89c2-226">If you attempt to set the instruction pointer to a memory address not marked as executable, the processor will throw an exception (general-protection violation), causing the application to crash.</span></span>

### <a name="compatibility-considerations"></a><span data-ttu-id="a89c2-227">Considerações sobre compatibilidade</span><span class="sxs-lookup"><span data-stu-id="a89c2-227">Compatibility considerations</span></span>

<span data-ttu-id="a89c2-228">Todos os executáveis x64, ARM e ARM-64 têm o DEP habilitado por padrão e não podem ser desabilitados.</span><span class="sxs-lookup"><span data-stu-id="a89c2-228">All x64, ARM, and ARM-64 executables have DEP enabled by default, and it cannot be disabled.</span></span> <span data-ttu-id="a89c2-229">Como um aplicativo nunca será executado sem a DEP, a compatibilidade é assumida.</span><span class="sxs-lookup"><span data-stu-id="a89c2-229">Since an application will have never been executed without DEP, compatibility is assumed.</span></span>

<span data-ttu-id="a89c2-230">Todos os binários x86 (32 bits) têm o DEP habilitado por padrão, mas o DEP pode ser desabilitado por processo.</span><span class="sxs-lookup"><span data-stu-id="a89c2-230">All x86 (32-bit) binaries have DEP enabled by default, but DEP can be disabled per process.</span></span> <span data-ttu-id="a89c2-231">Alguns aplicativos antigos herdáveis, normalmente aplicativos desenvolvidos antes do Windows XP SP2, podem não ser compatíveis com o DEP.</span><span class="sxs-lookup"><span data-stu-id="a89c2-231">Some old legacy applications, typically applications developed prior to Windows XP SP2, might not be compatible with DEP.</span></span> <span data-ttu-id="a89c2-232">Esses aplicativos normalmente geram código dinamicamente (por exemplo, compilação JIT) ou link para bibliotecas mais antigas (como versões mais antigas do ATL) que geram código dinamicamente.</span><span class="sxs-lookup"><span data-stu-id="a89c2-232">Such applications typically generate code dynamically (for example, JIT compiling) or link to older libraries (such as older versions of ATL) which dynamically generate code.</span></span>

### <a name="configuration-options"></a><span data-ttu-id="a89c2-233">Opções de configuração</span><span class="sxs-lookup"><span data-stu-id="a89c2-233">Configuration options</span></span>

<span data-ttu-id="a89c2-234">**Habilitar a emulação thunk atl** - Essa opção de configuração desabilita a emulação thunk atl.</span><span class="sxs-lookup"><span data-stu-id="a89c2-234">**Enable ATL Thunk emulation** - This configuration option disables ATL Thunk emulation.</span></span> <span data-ttu-id="a89c2-235">A ATL, a ActiveX de modelos, foi projetada para ser o mais pequeno e rápido possível.</span><span class="sxs-lookup"><span data-stu-id="a89c2-235">ATL, the ActiveX Template Library, is designed to be as small and fast as possible.</span></span> <span data-ttu-id="a89c2-236">Para reduzir o tamanho binário, ele usaria uma técnica chamada *thunking*.</span><span class="sxs-lookup"><span data-stu-id="a89c2-236">In order to reduce binary size, it would use a technique called *thunking*.</span></span> <span data-ttu-id="a89c2-237">O thunking normalmente é pensado para interagir entre aplicativos de 32 e 16 bits, mas não há componentes de 16 bits para ATL aqui.</span><span class="sxs-lookup"><span data-stu-id="a89c2-237">Thunking is typically thought of for interacting between 32-bit and 16-bit applications, but there are no 16-bit components to ATL here.</span></span> <span data-ttu-id="a89c2-238">Em vez disso, para otimizar o tamanho binário, a ATL armazenará o código do computador na memória que não esteja alinhado a palavras (criando um binário menor) e invocará esse código diretamente.</span><span class="sxs-lookup"><span data-stu-id="a89c2-238">Rather, in order to optimize for binary size, ATL will store machine code in memory that is not word-aligned (creating a smaller binary), and then invoke that code directly.</span></span> <span data-ttu-id="a89c2-239">Os componentes ATL compilados com Visual Studio 7.1 ou anteriores (Visual Studio 2003) não alocam essa memória como executável - a emulação thunk resolve esse problema de compatibilidade.</span><span class="sxs-lookup"><span data-stu-id="a89c2-239">ATL components compiled with Visual Studio 7.1 or earlier (Visual Studio 2003) do not allocate this memory as executable - thunk emulation resolves that compatibility issue.</span></span> <span data-ttu-id="a89c2-240">Os aplicativos que têm um modelo de extensão binária (como o Internet Explorer 11) geralmente precisarão ter a emulação thunk ATL habilitada.</span><span class="sxs-lookup"><span data-stu-id="a89c2-240">Applications that have a binary extension model (such as Internet Explorer 11) will often need to have ATL Thunk emulation enabled.</span></span>

## <a name="disable-extension-points"></a><span data-ttu-id="a89c2-241">Desabilitar pontos de extensão</span><span class="sxs-lookup"><span data-stu-id="a89c2-241">Disable extension points</span></span>

### <a name="description"></a><span data-ttu-id="a89c2-242">Descrição</span><span class="sxs-lookup"><span data-stu-id="a89c2-242">Description</span></span>

<span data-ttu-id="a89c2-243">Essa mitigação desabilita vários pontos de extensão de um aplicativo, que podem ser usados para estabelecer persistência ou elevar privilégios de conteúdo mal-intencionado.</span><span class="sxs-lookup"><span data-stu-id="a89c2-243">This mitigation disables various extension points for an application, which might be used to establish persistence or elevate privileges of malicious content.</span></span>

<span data-ttu-id="a89c2-244">Isso inclui:</span><span class="sxs-lookup"><span data-stu-id="a89c2-244">This includes:</span></span>

- <span data-ttu-id="a89c2-245">**AppInit DLLs** - Sempre que um processo é iniciado, o sistema carrega a DLL especificada para o contexto do processo recém-iniciado antes de chamar sua função de ponto de entrada.</span><span class="sxs-lookup"><span data-stu-id="a89c2-245">**AppInit DLLs** - Whenever a process starts, the system will load the specified DLL into to context of the newly started process before calling its entry point function.</span></span> <span data-ttu-id="a89c2-246">[Detalhes sobre DLLs appInit podem ser encontrados aqui](https://docs.microsoft.com/windows/win32/winmsg/about-window-classes#application-global-classes).</span><span class="sxs-lookup"><span data-stu-id="a89c2-246">[Details on AppInit DLLs can be found here](https://docs.microsoft.com/windows/win32/winmsg/about-window-classes#application-global-classes).</span></span> <span data-ttu-id="a89c2-247">Com essa mitigação aplicada, as DLLs appInit não são carregadas.</span><span class="sxs-lookup"><span data-stu-id="a89c2-247">With this mitigation applied, AppInit DLLs are not loaded.</span></span> <span data-ttu-id="a89c2-248">A partir do Windows 7, as DLLs appInit precisam ser assinadas digitalmente, [conforme descrito aqui](https://docs.microsoft.com/windows/win32/win7appqual/appinit-dlls-in-windows-7-and-windows-server-2008-r2).</span><span class="sxs-lookup"><span data-stu-id="a89c2-248">Beginning with Windows 7, AppInit DLLs need to be digitally signed, [as described here](https://docs.microsoft.com/windows/win32/win7appqual/appinit-dlls-in-windows-7-and-windows-server-2008-r2).</span></span> <span data-ttu-id="a89c2-249">Além disso, a partir do Windows 8, as DLLs do AppInit não serão carregadas se SecureBoot estiver habilitado, conforme [descrito aqui](https://docs.microsoft.com/windows/win32/dlls/secure-boot-and-appinit-dlls).</span><span class="sxs-lookup"><span data-stu-id="a89c2-249">Additionally, beginning with Windows 8, AppInit DLLs will not be loaded if SecureBoot is enabled, [as described here](https://docs.microsoft.com/windows/win32/dlls/secure-boot-and-appinit-dlls).</span></span>
- <span data-ttu-id="a89c2-250">**IMEs herdáveis** - Um Editor de Método de Entrada (IME) permite que um usuário digite texto em um idioma que tenha mais caracteres do que pode ser representado em um teclado.</span><span class="sxs-lookup"><span data-stu-id="a89c2-250">**Legacy IMEs** - An Input Method Editor (IME) allows a user to type text in a language that has more characters than can be represented on a keyboard.</span></span> <span data-ttu-id="a89c2-251">Terceiros podem criar IMEs.</span><span class="sxs-lookup"><span data-stu-id="a89c2-251">Third parties are able to create IMEs.</span></span> <span data-ttu-id="a89c2-252">Um IME mal-intencionado pode obter credenciais ou outras informações confidenciais dessa captura de entrada.</span><span class="sxs-lookup"><span data-stu-id="a89c2-252">A malicious IME might obtain credentials or other sensitive information from this input capture.</span></span> <span data-ttu-id="a89c2-253">Algumas IMEs, conhecidas como IMEs Herdadas, funcionarão apenas em aplicativos da Área de Trabalho do Windows e não em aplicativos UWP.</span><span class="sxs-lookup"><span data-stu-id="a89c2-253">Some IMEs, referred to as Legacy IMEs, will only work on Windows Desktop apps, and not UWP apps.</span></span> <span data-ttu-id="a89c2-254">Essa mitigação também impedirá que esse IME herdado seja carregado no aplicativo da Área de Trabalho do Windows especificado.</span><span class="sxs-lookup"><span data-stu-id="a89c2-254">This mitigation will also prevent this legacy IME from loading into the specified Windows Desktop app.</span></span>
- <span data-ttu-id="a89c2-255">**Ganchos de Eventos do Windows** - Um aplicativo pode chamar a API [SetWinEventHook](https://docs.microsoft.com/windows/win32/api/winuser/nf-winuser-setwineventhook) para registrar o interesse em um evento que está ocorrendo.</span><span class="sxs-lookup"><span data-stu-id="a89c2-255">**Windows Event Hooks** - An application can call the [SetWinEventHook API](https://docs.microsoft.com/windows/win32/api/winuser/nf-winuser-setwineventhook) to register interest in an event taking place.</span></span> <span data-ttu-id="a89c2-256">Uma DLL é especificada e pode ser injetada no processo.</span><span class="sxs-lookup"><span data-stu-id="a89c2-256">A DLL is specified and can be injected into the process.</span></span> <span data-ttu-id="a89c2-257">Essa mitigação força o gancho a ser postado no processo de registro em vez de executar no processo por meio de uma DLL injetada.</span><span class="sxs-lookup"><span data-stu-id="a89c2-257">This mitigation forces the hook to be posted to the registering process rather than running in-process through an injected DLL.</span></span>

### <a name="compatibility-considerations"></a><span data-ttu-id="a89c2-258">Considerações sobre compatibilidade</span><span class="sxs-lookup"><span data-stu-id="a89c2-258">Compatibility considerations</span></span>

<span data-ttu-id="a89c2-259">A maioria desses pontos de extensão são usados com pouca freqüência, portanto, o impacto da compatibilidade é geralmente pequeno, particularmente em um nível de aplicativo individual.</span><span class="sxs-lookup"><span data-stu-id="a89c2-259">Most of these extension points are relatively infrequently used, so compatibility impact is typically small, particularly at an individual application level.</span></span> <span data-ttu-id="a89c2-260">A única consideração é se os usuários estão usando IMEs Herdadas de terceiros que não funcionarão com o aplicativo protegido.</span><span class="sxs-lookup"><span data-stu-id="a89c2-260">The one consideration is if users are using third-party Legacy IMEs that will not work with the protected application.</span></span>

### <a name="configuration-options"></a><span data-ttu-id="a89c2-261">Opções de configuração</span><span class="sxs-lookup"><span data-stu-id="a89c2-261">Configuration options</span></span>

<span data-ttu-id="a89c2-262">Não há opções de configuração para essa mitigação.</span><span class="sxs-lookup"><span data-stu-id="a89c2-262">There are no configuration options for this mitigation.</span></span>

> [!Note]
> <span data-ttu-id="a89c2-263">**Desabilitar pontos de extensão** não tem modo de auditoria.</span><span class="sxs-lookup"><span data-stu-id="a89c2-263">**Disable extension points** has no audit mode.</span></span>

## <a name="disable-win32k-system-calls"></a><span data-ttu-id="a89c2-264">Desabilitar chamadas do sistema Win32k</span><span class="sxs-lookup"><span data-stu-id="a89c2-264">Disable Win32k system calls</span></span>

### <a name="description"></a><span data-ttu-id="a89c2-265">Descrição</span><span class="sxs-lookup"><span data-stu-id="a89c2-265">Description</span></span>

<span data-ttu-id="a89c2-266">Win32k.sys fornece uma ampla superfície de ataque para um invasor.</span><span class="sxs-lookup"><span data-stu-id="a89c2-266">Win32k.sys provides a broad attack surface for an attacker.</span></span> <span data-ttu-id="a89c2-267">Como um componente do modo kernel, ele é frequentemente direcionado como um vetor de escape para aplicativos que são áreas de segurança.</span><span class="sxs-lookup"><span data-stu-id="a89c2-267">As a kernel-mode component, it is frequently targeted as an escape vector for applications that are sandboxed.</span></span> <span data-ttu-id="a89c2-268">Essa mitigação impede chamadas em win32k.sys bloqueando que um thread se converta em um thread de GUI, que recebe acesso para invocar funções win32k.</span><span class="sxs-lookup"><span data-stu-id="a89c2-268">This mitigation prevents calls into win32k.sys by blocking a thread from converting itself into a GUI thread, which is then given access to invoke Win32k functions.</span></span> <span data-ttu-id="a89c2-269">Um thread não é GUI quando criado, mas convertido na primeira chamada para win32k.sys ou por meio de uma chamada de API para [IsGuiThread](https://docs.microsoft.com/windows/win32/api/winuser/nf-winuser-isguithread).</span><span class="sxs-lookup"><span data-stu-id="a89c2-269">A thread is non-GUI when created, but converted on first call to win32k.sys, or through an API call to [IsGuiThread](https://docs.microsoft.com/windows/win32/api/winuser/nf-winuser-isguithread).</span></span>

### <a name="compatibility-considerations"></a><span data-ttu-id="a89c2-270">Considerações sobre compatibilidade</span><span class="sxs-lookup"><span data-stu-id="a89c2-270">Compatibility considerations</span></span>

<span data-ttu-id="a89c2-271">Essa mitigação foi projetada para processos que são processos não da interface do usuário dedicados.</span><span class="sxs-lookup"><span data-stu-id="a89c2-271">This mitigation is designed for processes that are dedicated non-UI processes.</span></span> <span data-ttu-id="a89c2-272">Por exemplo, muitos navegadores modernos usarão o isolamento do processo e incorporarão processos que não são da interface do usuário.</span><span class="sxs-lookup"><span data-stu-id="a89c2-272">For example, many modern browsers will use process isolation and incorporate non-UI processes.</span></span> <span data-ttu-id="a89c2-273">Qualquer aplicativo que exibe uma GUI usando um único processo será afetado por essa mitigação.</span><span class="sxs-lookup"><span data-stu-id="a89c2-273">Any application that displays a GUI using a single process will be impacted by this mitigation.</span></span>

### <a name="configuration-options"></a><span data-ttu-id="a89c2-274">Opções de configuração</span><span class="sxs-lookup"><span data-stu-id="a89c2-274">Configuration options</span></span>

<span data-ttu-id="a89c2-275">**Somente auditoria** - Você pode habilitar essa mitigação no modo de auditoria para medir o impacto potencial da compatibilidade em um aplicativo.</span><span class="sxs-lookup"><span data-stu-id="a89c2-275">**Audit Only** - You can enable this mitigation in audit mode in order to measure the potential compatibility impact on an application.</span></span> <span data-ttu-id="a89c2-276">Os eventos de auditoria podem ser exibidos no visualizador de eventos ou usando a Busca Avançada no [Microsoft Defender para Ponto de Extremidade.](https://docs.microsoft.com/microsoft-365/security/defender/advanced-hunting-overview)</span><span class="sxs-lookup"><span data-stu-id="a89c2-276">Audit events can then be viewed either in the event viewer or using Advanced Hunting in [Microsoft Defender for Endpoint](https://docs.microsoft.com/microsoft-365/security/defender/advanced-hunting-overview).</span></span>

## <a name="do-not-allow-child-processes"></a><span data-ttu-id="a89c2-277">Não permitir processos filho</span><span class="sxs-lookup"><span data-stu-id="a89c2-277">Do not allow child processes</span></span>

### <a name="description"></a><span data-ttu-id="a89c2-278">Descrição</span><span class="sxs-lookup"><span data-stu-id="a89c2-278">Description</span></span>

<span data-ttu-id="a89c2-279">Essa mitigação impede que um aplicativo cria novos aplicativos filho.</span><span class="sxs-lookup"><span data-stu-id="a89c2-279">This mitigation prevents an application from creating new child applications.</span></span> <span data-ttu-id="a89c2-280">Uma técnica comum usada por adversários é iniciar um processo confiável no dispositivo com entrada mal-intencionada (um ataque de "vida fora da terra"), que geralmente exige o lançamento de outro aplicativo no dispositivo.</span><span class="sxs-lookup"><span data-stu-id="a89c2-280">A common technique used by adversaries is to initiate a trusted process on the device with malicious input (a "living off the land" attack), which often requires launching another application on the device.</span></span> <span data-ttu-id="a89c2-281">Se não houver motivos legítimos para um aplicativo iniciar um processo filho, essa mitigação atenua esse possível vetor de ataque.</span><span class="sxs-lookup"><span data-stu-id="a89c2-281">If there are no legitimate reasons why an application would launch a child process, this mitigation mitigates that potential attack vector.</span></span> <span data-ttu-id="a89c2-282">A mitigação é aplicada definindo uma propriedade no token de processo, que bloqueia a criação de um token para o processo filho com a mensagem de erro STATUS_CHILD_PROCESS_BLOCKED.</span><span class="sxs-lookup"><span data-stu-id="a89c2-282">The mitigation is applied by setting a property on the process token, which blocks creating a token for the child process with the error message STATUS_CHILD_PROCESS_BLOCKED.</span></span>

### <a name="compatibility-considerations"></a><span data-ttu-id="a89c2-283">Considerações sobre compatibilidade</span><span class="sxs-lookup"><span data-stu-id="a89c2-283">Compatibility considerations</span></span>

<span data-ttu-id="a89c2-284">Se o aplicativo iniciar aplicativos filho por qualquer motivo, como suporte a hiperlinks que iniciam um navegador ou um navegador externo, ou que iniciam outros utilitários no computador, essa funcionalidade será interrompida com essa mitigação aplicada.</span><span class="sxs-lookup"><span data-stu-id="a89c2-284">If your application launches child applications for any reason, such as supporting hyperlinks that launch a browser or an external browser, or which launch other utilities on the computer, this functionality will be broken with this mitigation applied.</span></span>

### <a name="configuration-options"></a><span data-ttu-id="a89c2-285">Opções de configuração</span><span class="sxs-lookup"><span data-stu-id="a89c2-285">Configuration options</span></span>

<span data-ttu-id="a89c2-286">**Somente auditoria** - Você pode habilitar essa mitigação no modo de auditoria para medir o impacto potencial da compatibilidade em um aplicativo.</span><span class="sxs-lookup"><span data-stu-id="a89c2-286">**Audit Only** - You can enable this mitigation in audit mode in order to measure the potential compatibility impact on an application.</span></span> <span data-ttu-id="a89c2-287">Os eventos de auditoria podem ser exibidos no visualizador de eventos ou usando a Busca Avançada no [Microsoft Defender para Ponto de Extremidade.](https://docs.microsoft.com/microsoft-365/security/defender/advanced-hunting-overview)</span><span class="sxs-lookup"><span data-stu-id="a89c2-287">Audit events can then be viewed either in the event viewer or using Advanced Hunting in [Microsoft Defender for Endpoint](https://docs.microsoft.com/microsoft-365/security/defender/advanced-hunting-overview).</span></span>

## <a name="export-address-filtering"></a><span data-ttu-id="a89c2-288">Exportar filtragem de endereços</span><span class="sxs-lookup"><span data-stu-id="a89c2-288">Export address filtering</span></span>

### <a name="description"></a><span data-ttu-id="a89c2-289">Descrição</span><span class="sxs-lookup"><span data-stu-id="a89c2-289">Description</span></span>

<span data-ttu-id="a89c2-290">A filtragem de endereços de exportação (EAF) reduz o risco de código mal-intencionado olhando para a tabela de endereços de exportação de todos os módulos carregados para encontrar módulos que contenham APIs úteis para seu ataque.</span><span class="sxs-lookup"><span data-stu-id="a89c2-290">Export address filtering (EAF) mitigates the risk of malicious code looking at the export address table of all loaded modules to find modules that contain useful APIs for their attack.</span></span> <span data-ttu-id="a89c2-291">Essa é uma tática comum usada pelo shellcode.</span><span class="sxs-lookup"><span data-stu-id="a89c2-291">This is a common tactic used by shellcode.</span></span> <span data-ttu-id="a89c2-292">Para reduzir o risco de tal ataque, essa mitigação protege três módulos comumente atacados:</span><span class="sxs-lookup"><span data-stu-id="a89c2-292">In order to mitigate the risk of such an attack, this mitigation protects three commonly attacked modules:</span></span>

- <span data-ttu-id="a89c2-293">ntdll.dll</span><span class="sxs-lookup"><span data-stu-id="a89c2-293">ntdll.dll</span></span>
- <span data-ttu-id="a89c2-294">kernelbase.dll</span><span class="sxs-lookup"><span data-stu-id="a89c2-294">kernelbase.dll</span></span>
- <span data-ttu-id="a89c2-295">kernel32.dll</span><span class="sxs-lookup"><span data-stu-id="a89c2-295">kernel32.dll</span></span>

<span data-ttu-id="a89c2-296">A mitigação protege a página de memória no [diretório de exportação que aponta para a [tabela de endereços de exportação.](https://docs.microsoft.com/windows/win32/debug/pe-format#export-address-table)</span><span class="sxs-lookup"><span data-stu-id="a89c2-296">The mitigation protects the memory page in the [export directory that points to the [export address table](https://docs.microsoft.com/windows/win32/debug/pe-format#export-address-table).</span></span> <span data-ttu-id="a89c2-297">Esta página de memória terá a [proteção PAGE_GUARD](https://docs.microsoft.com/windows/win32/memory/creating-guard-pages) aplicada a ela.</span><span class="sxs-lookup"><span data-stu-id="a89c2-297">This memory page will have the [PAGE_GUARD](https://docs.microsoft.com/windows/win32/memory/creating-guard-pages) protection applied to it.</span></span> <span data-ttu-id="a89c2-298">Quando alguém tentar acessar essa memória, ela gerará uma STATUS_GUARD_PAGE_VIOLATION.</span><span class="sxs-lookup"><span data-stu-id="a89c2-298">When someone tries to access this memory, it will generate a STATUS_GUARD_PAGE_VIOLATION.</span></span> <span data-ttu-id="a89c2-299">A mitigação lida com essa exceção e, se a instrução de acesso não passar na validação, o processo será encerrado.</span><span class="sxs-lookup"><span data-stu-id="a89c2-299">The mitigation handles this exception, and if the accessing instruction doesn't pass validation, the process will be terminated.</span></span>

### <a name="compatibility-considerations"></a><span data-ttu-id="a89c2-300">Considerações sobre compatibilidade</span><span class="sxs-lookup"><span data-stu-id="a89c2-300">Compatibility considerations</span></span>

<span data-ttu-id="a89c2-301">Essa mitigação é principalmente um problema para aplicativos como depurador, aplicativos em áreas de segurança, aplicativos que usam DRM ou aplicativos que implementam a tecnologia anti-depuração.</span><span class="sxs-lookup"><span data-stu-id="a89c2-301">This mitigation is primarily an issue for applications such as debuggers, sandboxed applications, applications using DRM, or applications that implement anti-debugging technology.</span></span>

### <a name="configuration-options"></a><span data-ttu-id="a89c2-302">Opções de configuração</span><span class="sxs-lookup"><span data-stu-id="a89c2-302">Configuration options</span></span>

<span data-ttu-id="a89c2-303">**Validar o** acesso para módulos que são comumente abusadas por explorações - Essa opção, também conhecida como EAF+, adiciona proteções para outros módulos comumente atacados:</span><span class="sxs-lookup"><span data-stu-id="a89c2-303">**Validate access for modules that are commonly abused by exploits** - This option, also known as EAF+, adds protections for other commonly attacked modules:</span></span>

- `mshtml.dll`
- `flash*.ocx`
- `jscript*.ocx`
- `vbscript.dll`
- `vgx.dll`
- `mozjs.dll`
- `xul.dll`
- `acrord32.dll`
- `acrofx32.dll`
- `acroform.api`

<span data-ttu-id="a89c2-304">Além disso, habilitando o EAF+, essa mitigação adiciona a proteção PAGE_GUARD à página que contém o header "MZ", os dois primeiros bytes do [header do DOS](https://docs.microsoft.com/windows/win32/debug/pe-format#ms-dos-stub-image-only)em um arquivo PE, que é outro aspecto do conteúdo de memória conhecido que o shellcode pode procurar para identificar módulos potencialmente de interesse na memória.</span><span class="sxs-lookup"><span data-stu-id="a89c2-304">Additionally, by enabling EAF+, this mitigation adds the PAGE_GUARD protection to the page containing the "MZ" header, the first two bytes of the [DOS header in a PE file](https://docs.microsoft.com/windows/win32/debug/pe-format#ms-dos-stub-image-only), which is another aspect of known memory content which shellcode can look for to identify modules potentially of interest in memory.</span></span>

<span data-ttu-id="a89c2-305">**Somente auditoria** - Você pode habilitar essa mitigação no modo de auditoria para medir o impacto potencial da compatibilidade em um aplicativo.</span><span class="sxs-lookup"><span data-stu-id="a89c2-305">**Audit Only** - You can enable this mitigation in audit mode in order to measure the potential compatibility impact on an application.</span></span> <span data-ttu-id="a89c2-306">Os eventos de auditoria podem ser exibidos no visualizador de eventos ou usando a Busca Avançada no [Microsoft Defender para Ponto de Extremidade.](https://docs.microsoft.com/microsoft-365/security/defender/advanced-hunting-overview)</span><span class="sxs-lookup"><span data-stu-id="a89c2-306">Audit events can then be viewed either in the event viewer or using Advanced Hunting in [Microsoft Defender for Endpoint](https://docs.microsoft.com/microsoft-365/security/defender/advanced-hunting-overview).</span></span>

## <a name="force-randomization-for-images-mandatory-aslr"></a><span data-ttu-id="a89c2-307">Forçar a randomização para imagens (ASLR obrigatória)</span><span class="sxs-lookup"><span data-stu-id="a89c2-307">Force randomization for images (Mandatory ASLR)</span></span>

### <a name="description"></a><span data-ttu-id="a89c2-308">Descrição</span><span class="sxs-lookup"><span data-stu-id="a89c2-308">Description</span></span>

<span data-ttu-id="a89c2-309">A Randomização de Layout de Espaço de Endereço (ASLR) reduz o risco de um invasor usar seu conhecimento do layout de memória do sistema para executar um código que já está presente na memória do processo e já marcado como executável.</span><span class="sxs-lookup"><span data-stu-id="a89c2-309">Address Space Layout Randomization (ASLR) mitigates the risk of an attacker using their knowledge of the memory layout of the system in order to execute code that is already present in process memory and already marked as executable.</span></span> <span data-ttu-id="a89c2-310">Isso pode reduzir o risco de um invasor usar técnicas como ataques de retorno para libc, onde o adversário define o contexto e modifica o endereço de retorno para executar o código existente com contexto que se adéque à finalidade do adversário.</span><span class="sxs-lookup"><span data-stu-id="a89c2-310">This can mitigate the risk of an attacker using techniques such as return-to-libc attacks, where the adversary sets the context and then modifies the return address to execute existing code with context that suits the adversary's purpose.</span></span>

<span data-ttu-id="a89c2-311">O ASLR obrigatório força uma rebase de todas as DLLs dentro do processo.</span><span class="sxs-lookup"><span data-stu-id="a89c2-311">Mandatory ASLR forces a rebase of all DLLs within the process.</span></span> <span data-ttu-id="a89c2-312">Um desenvolvedor pode habilitar o ASLR usando a [opção linker /DYNAMICBASE](https://docs.microsoft.com/cpp/build/reference/dynamicbase-use-address-space-layout-randomization?view=vs-2019&preserve-view=true) e essa mitigação tem o mesmo efeito.</span><span class="sxs-lookup"><span data-stu-id="a89c2-312">A developer can enable ASLR using the [/DYNAMICBASE](https://docs.microsoft.com/cpp/build/reference/dynamicbase-use-address-space-layout-randomization?view=vs-2019&preserve-view=true) linker option, and this mitigation has the same effect.</span></span>

<span data-ttu-id="a89c2-313">Quando o gerenciador de memória estiver mapeando a imagem para o processo, o ASLR obrigatório irá rebaixar à força DLLs e EXEs que não optaram por ASLR.</span><span class="sxs-lookup"><span data-stu-id="a89c2-313">When the memory manager is mapping in the image into the process, Mandatory ASLR will forcibly rebase DLLs and EXEs that have not opted in to ASLR.</span></span> <span data-ttu-id="a89c2-314">Observe, no entanto, que esse rebasamento não tem entropia e, portanto, pode ser colocado em um local previsível na memória.</span><span class="sxs-lookup"><span data-stu-id="a89c2-314">Note, however, that this rebasing has no entropy, and can therefore be placed at a predictable location in memory.</span></span> <span data-ttu-id="a89c2-315">Para localização rebaixada e aleatória de binários, essa mitigação deve ser emparelhada com alocações de memória [Randomize (ASLR](#randomize-memory-allocations-bottom-up-aslr)inferior para cima) .</span><span class="sxs-lookup"><span data-stu-id="a89c2-315">For rebased and randomized location of binaries, this mitigation should be paired with [Randomize memory allocations (Bottom-up ASLR)](#randomize-memory-allocations-bottom-up-aslr).</span></span>

### <a name="compatibility-considerations"></a><span data-ttu-id="a89c2-316">Considerações sobre compatibilidade</span><span class="sxs-lookup"><span data-stu-id="a89c2-316">Compatibility considerations</span></span>

<span data-ttu-id="a89c2-317">Esse impacto de compatibilidade do ASLR normalmente é restrito a aplicativos mais antigos que foram construídos usando compiladores que fizeram suposições sobre o endereço base de um arquivo binário ou despojaram informações de realocação base.</span><span class="sxs-lookup"><span data-stu-id="a89c2-317">This compatibility impact of ASLR is typically constrained to older applications that were built using compilers that made assumptions about the base address of a binary file or have stripped out base relocation information.</span></span> <span data-ttu-id="a89c2-318">Isso pode levar a erros imprevisíveis à medida que o fluxo de execução tenta ir para o local esperado, em vez do local real na memória.</span><span class="sxs-lookup"><span data-stu-id="a89c2-318">This can lead to unpredictable errors as the execution flow attempts to jump to the expected, rather than the actual, location in memory.</span></span>

### <a name="configuration-options"></a><span data-ttu-id="a89c2-319">Opções de configuração</span><span class="sxs-lookup"><span data-stu-id="a89c2-319">Configuration options</span></span>

<span data-ttu-id="a89c2-320">**Não permitir imagens despojadas** - Essa opção bloqueia o carregamento de imagens que tiveram as informações de realocação despojadas.</span><span class="sxs-lookup"><span data-stu-id="a89c2-320">**Do not allow stripped images** - This option blocks the loading of images that have had relocation information stripped.</span></span> <span data-ttu-id="a89c2-321">O formato de arquivo do Windows PE contém endereços absolutos, e o compilador também gera uma [tabela de realocação base que o carregador pode usar para encontrar todas as referências de memória relativas e seu deslocamento, para que eles possam ser atualizados se o binário não carregar em seu endereço base preferencial.</span><span class="sxs-lookup"><span data-stu-id="a89c2-321">The Windows PE file format contains absolute addresses, and the compiler also generates a [base relocation table that the loader can use to find all relative memory references and their offset, so they can be updated if the binary does not load at its preferred base address.</span></span> <span data-ttu-id="a89c2-322">Alguns aplicativos mais antigos retiram essas informações em builds de produção e, portanto, esses binários não podem ser rebasados.</span><span class="sxs-lookup"><span data-stu-id="a89c2-322">Some older applications strip out this information in production builds, and therefore these binaries cannot be rebased.</span></span> <span data-ttu-id="a89c2-323">Essa mitigação impede que esses binários são carregados (em vez de permitir que eles carreguem no endereço base preferencial).</span><span class="sxs-lookup"><span data-stu-id="a89c2-323">This mitigation blocks such binaries from being loaded (instead of allowing them to load at their preferred base address).</span></span>

> [!Note]
> <span data-ttu-id="a89c2-324">**Forçar a randomização para imagens (ASLR obrigatória)** não tem modo de auditoria.</span><span class="sxs-lookup"><span data-stu-id="a89c2-324">**Force randomization for images (Mandatory ASLR)** has no audit mode.</span></span>

## <a name="import-address-filtering-iaf"></a><span data-ttu-id="a89c2-325">Importar filtragem de endereços (IAF)</span><span class="sxs-lookup"><span data-stu-id="a89c2-325">Import address filtering (IAF)</span></span>

### <a name="description"></a><span data-ttu-id="a89c2-326">Descrição</span><span class="sxs-lookup"><span data-stu-id="a89c2-326">Description</span></span>

<span data-ttu-id="a89c2-327">A mitigação de filtragem de endereços de importação (IAF) ajuda a reduzir o risco de um adversário alterar o fluxo de controle de um aplicativo modificando a tabela de endereços de importação (IAT) para redirecionar para o código arbitrário da escolha do invasor quando essa função for chamada.</span><span class="sxs-lookup"><span data-stu-id="a89c2-327">The import address filtering (IAF) mitigation helps mitigate the risk of an adversary changing the control flow of an application by modifying the import address table (IAT) to redirect to arbitrary code of the attacker's choice when that function is called.</span></span> <span data-ttu-id="a89c2-328">Um invasor pode usar essa abordagem para seqüestrar o controle ou interceptar, inspecionar e potencialmente bloquear chamadas para APIs confidenciais.</span><span class="sxs-lookup"><span data-stu-id="a89c2-328">An attacker could use this approach to hijack control, or to intercept, inspect, and potentially block calls to sensitive APIs.</span></span>

<span data-ttu-id="a89c2-329">As páginas de memória para todas as APIs protegidas terão a [proteção PAGE_GUARD](https://docs.microsoft.com/windows/win32/memory/creating-guard-pages) aplicada a elas.</span><span class="sxs-lookup"><span data-stu-id="a89c2-329">The memory pages for all protected APIs will have the [PAGE_GUARD](https://docs.microsoft.com/windows/win32/memory/creating-guard-pages) protection applied to them.</span></span> <span data-ttu-id="a89c2-330">Quando alguém tentar acessar essa memória, ela gerará uma STATUS_GUARD_PAGE_VIOLATION.</span><span class="sxs-lookup"><span data-stu-id="a89c2-330">When someone tries to access this memory, it will generate a STATUS_GUARD_PAGE_VIOLATION.</span></span> <span data-ttu-id="a89c2-331">A mitigação lida com essa exceção e, se a instrução de acesso não passar na validação, o processo será encerrado.</span><span class="sxs-lookup"><span data-stu-id="a89c2-331">The mitigation handles this exception, and if the accessing instruction doesn't pass validation, the process will be terminated.</span></span>

<span data-ttu-id="a89c2-332">Essa mitigação protege as seguintes APIs do Windows:</span><span class="sxs-lookup"><span data-stu-id="a89c2-332">This mitigation protects the following Windows APIs:</span></span>

- `GetProcAddress`
- `GetProcAddressForCaller`
- `LoadLibraryA`
- `LoadLibraryExA`
- `LoadLibraryW`
- `LoadLibraryExW`
- `LdrGetProcedureAddress`
- `LdrGetProcedureAddressEx`
- `LdrGetProcedureAddressForCaller`
- `LdrLoadDll`
- `VirtualProtect`
- `VirtualProtectEx`
- `VirtualAlloc`
- `VirtualAllocEx`
- `NtAllocateVirtualMemory`
- `NtProtectVirtualMemory`
- `CreateProcessA`
- `CreateProcessW`
- `WinExec`
- `CreateProcessAsUserA`
- `CreateProcessAsUserW`
- `GetModuleHandleA`
- `GetModuleHandleW`
- `RtlDecodePointer`
- `DecodePointer`

### <a name="compatibility-considerations"></a><span data-ttu-id="a89c2-333">Considerações sobre compatibilidade</span><span class="sxs-lookup"><span data-stu-id="a89c2-333">Compatibility considerations</span></span>

<span data-ttu-id="a89c2-334">Aplicativos legítimos que executam interceptação de API podem ser detectados por essa mitigação e fazer com que alguns aplicativos falham.</span><span class="sxs-lookup"><span data-stu-id="a89c2-334">Legitimate applications that perform API interception may be detected by this mitigation and cause some applications to crash.</span></span> <span data-ttu-id="a89c2-335">Exemplos incluem software de segurança e compatibilidade de aplicativos.</span><span class="sxs-lookup"><span data-stu-id="a89c2-335">Examples include security software and application compatibility shims.</span></span>

### <a name="configuration-options"></a><span data-ttu-id="a89c2-336">Opções de configuração</span><span class="sxs-lookup"><span data-stu-id="a89c2-336">Configuration options</span></span>

<span data-ttu-id="a89c2-337">**Somente auditoria** - Você pode habilitar essa mitigação no modo de auditoria para medir o impacto potencial da compatibilidade em um aplicativo.</span><span class="sxs-lookup"><span data-stu-id="a89c2-337">**Audit Only** - You can enable this mitigation in audit mode in order to measure the potential compatibility impact on an application.</span></span> <span data-ttu-id="a89c2-338">Os eventos de auditoria podem ser exibidos no visualizador de eventos ou usando a Busca Avançada no [Microsoft Defender para Ponto de Extremidade.](https://docs.microsoft.com/microsoft-365/security/defender/advanced-hunting-overview)</span><span class="sxs-lookup"><span data-stu-id="a89c2-338">Audit events can then be viewed either in the event viewer or using Advanced Hunting in [Microsoft Defender for Endpoint](https://docs.microsoft.com/microsoft-365/security/defender/advanced-hunting-overview).</span></span>

## <a name="randomize-memory-allocations-bottom-up-aslr"></a><span data-ttu-id="a89c2-339">Randomize alocações de memória (ASLR de baixo para cima)</span><span class="sxs-lookup"><span data-stu-id="a89c2-339">Randomize memory allocations (Bottom-up ASLR)</span></span>

### <a name="description"></a><span data-ttu-id="a89c2-340">Descrição</span><span class="sxs-lookup"><span data-stu-id="a89c2-340">Description</span></span>

<span data-ttu-id="a89c2-341">Alocações de memória aleatórias (ASLR de baixo para cima) adiciona entropia a relocações, portanto, sua localização é aleatória e, portanto, menos previsível.</span><span class="sxs-lookup"><span data-stu-id="a89c2-341">Randomize memory allocations (Bottom-up ASLR) adds entropy to relocations, so their location is randomized and therefore less predictable.</span></span> <span data-ttu-id="a89c2-342">Essa mitigação exige que o ASLR obrigatório entre em vigor.</span><span class="sxs-lookup"><span data-stu-id="a89c2-342">This mitigation requires Mandatory ASLR to take effect.</span></span>

<span data-ttu-id="a89c2-343">O tamanho do espaço de endereço de 32 bits coloca restrições práticas na entropia que podem ser adicionadas e, portanto, os aplicativos de 64 bits dificultam para um invasor adivinhar um local na memória.</span><span class="sxs-lookup"><span data-stu-id="a89c2-343">The size of the 32-bit address space places practical constraints on the entropy that can be added, and therefore 64-bit applications make it more difficult for an attacker to guess a location in memory.</span></span>

### <a name="compatibility-considerations"></a><span data-ttu-id="a89c2-344">Considerações sobre compatibilidade</span><span class="sxs-lookup"><span data-stu-id="a89c2-344">Compatibility considerations</span></span>

<span data-ttu-id="a89c2-345">A maioria dos aplicativos compatíveis com o ASLR obrigatório (rebasamento) também é compatível com a outra entropia do ASLR de bottom-up.</span><span class="sxs-lookup"><span data-stu-id="a89c2-345">Most applications that are compatible with Mandatory ASLR (rebasing) are also compatible with the other entropy of Bottom-up ASLR.</span></span> <span data-ttu-id="a89c2-346">Alguns aplicativos podem ter problemas de truncamento de ponteiro se eles estão salvando ponteiros locais em variáveis de 32 bits (esperando um endereço base abaixo de 4 GB) e, portanto, serão incompatíveis com a opção de alta entropia (que pode ser desabilitada).</span><span class="sxs-lookup"><span data-stu-id="a89c2-346">Some applications may have pointer-truncation issues if they are saving local pointers in 32-bit variables (expecting a base address below 4 GB), and thus will be incompatible with the high entropy option (which can be disabled).</span></span>

### <a name="configuration-options"></a><span data-ttu-id="a89c2-347">Opções de configuração</span><span class="sxs-lookup"><span data-stu-id="a89c2-347">Configuration options</span></span>

<span data-ttu-id="a89c2-348">Não use alta **entropia** - essa opção desabilita o uso de ASLR de alta entropia, que adiciona 24 bits de entropia (1 TB de variação) à alocação inferior para aplicativos de 64 bits.</span><span class="sxs-lookup"><span data-stu-id="a89c2-348">**Don't use high entropy** - this option disables the use of high-entropy ASLR, which adds 24 bits of entropy (1 TB of variance) into the bottom-up allocation for 64-bit applications.</span></span>

> [!Note]
> <span data-ttu-id="a89c2-349">**Alocações de memória aleatórias (ASLR** inferior para cima) não tem modo de auditoria.</span><span class="sxs-lookup"><span data-stu-id="a89c2-349">**Randomize memory allocations (Bottom-up ASLR)** has no audit mode.</span></span>

## <a name="simulate-execution-simexec"></a><span data-ttu-id="a89c2-350">Simular execução (SimExec)</span><span class="sxs-lookup"><span data-stu-id="a89c2-350">Simulate execution (SimExec)</span></span>

### <a name="description"></a><span data-ttu-id="a89c2-351">Descrição</span><span class="sxs-lookup"><span data-stu-id="a89c2-351">Description</span></span>

<span data-ttu-id="a89c2-352">Simular execução (SimExec) é uma mitigação apenas para aplicativos de 32 bits.</span><span class="sxs-lookup"><span data-stu-id="a89c2-352">Simulate execution (SimExec) is a mitigation for 32-bit applications only.</span></span> <span data-ttu-id="a89c2-353">Isso ajuda a validar que as chamadas para APIs confidenciais retornarão às funções legítimas do chamador.</span><span class="sxs-lookup"><span data-stu-id="a89c2-353">This helps validate that calls to sensitive APIs will return to legitimate caller functions.</span></span> <span data-ttu-id="a89c2-354">Ele faz isso interceptando chamadas em APIs confidenciais e simulando a execução dessas APIs, passeando pelas instruções de idioma de assembly codificado procurando a instrução RET, que deve retornar ao chamador.</span><span class="sxs-lookup"><span data-stu-id="a89c2-354">It does this by intercepting calls into sensitive APIs, and then simulating the execution of those APIs by walking through the encoded assembly language instructions looking for the RET instruction, which should return to the caller.</span></span> <span data-ttu-id="a89c2-355">Em seguida, ele inspeciona essa função e anda para trás na memória para encontrar a instrução CALL anterior para determinar se a função e a instrução CALL corresponderam e que a RET não foi interceptada.</span><span class="sxs-lookup"><span data-stu-id="a89c2-355">It then inspects that function and walks backwards in memory to find the preceding CALL instruction to determine whether the function and CALL instruction match, and that the RET hasn't been intercepted.</span></span>

<span data-ttu-id="a89c2-356">As APIs interceptadas por essa mitigação são:</span><span class="sxs-lookup"><span data-stu-id="a89c2-356">The APIs intercepted by this mitigation are:</span></span>

- `LoadLibraryA`
- `LoadLibraryW`
- `LoadLibraryExA`
- `LoadLibraryExW`
- `LdrLoadDll`
- `VirtualAlloc`
- `VirtualAllocEx`
- `NtAllocateVirtualMemory`
- `VirtualProtect`
- `VirtualProtectEx`
- `NtProtectVirtualMemory`
- `HeapCreate`
- `RtlCreateHeap`
- `CreateProcessA`
- `CreateProcessW`
- `CreateProcessInternalA`
- `CreateProcessInternalW`
- `NtCreateUserProcess`
- `NtCreateProcess`
- `NtCreateProcessEx`
- `CreateRemoteThread`
- `CreateRemoteThreadEx`
- `NtCreateThreadEx`
- `WriteProcessMemory`
- `NtWriteVirtualMemory`
- `WinExec`
- `CreateFileMappingA`
- `CreateFileMappingW`
- `CreateFileMappingNumaW`
- `NtCreateSection`
- `MapViewOfFile`
- `MapViewOfFileEx`
- `MapViewOfFileFromApp`
- `LdrGetProcedureAddressForCaller`

<span data-ttu-id="a89c2-357">Se um gadget ROP for detectado, o processo será encerrado.</span><span class="sxs-lookup"><span data-stu-id="a89c2-357">If a ROP gadget is detected, the process is terminated.</span></span>

### <a name="compatibility-considerations"></a><span data-ttu-id="a89c2-358">Considerações sobre compatibilidade</span><span class="sxs-lookup"><span data-stu-id="a89c2-358">Compatibility considerations</span></span>

<span data-ttu-id="a89c2-359">Aplicativos que executam interceptação de API, especialmente software de segurança, podem causar problemas de compatibilidade com essa mitigação.</span><span class="sxs-lookup"><span data-stu-id="a89c2-359">Applications that perform API interception, particularly security software, can cause compatibility problems with this mitigation.</span></span>

<span data-ttu-id="a89c2-360">Essa mitigação é incompatível com a mitigação do Code Guard arbitrário.</span><span class="sxs-lookup"><span data-stu-id="a89c2-360">This mitigation is incompatible with the Arbitrary Code Guard mitigation.</span></span>

### <a name="configuration-options"></a><span data-ttu-id="a89c2-361">Opções de configuração</span><span class="sxs-lookup"><span data-stu-id="a89c2-361">Configuration options</span></span>

<span data-ttu-id="a89c2-362">**Somente auditoria** - Você pode habilitar essa mitigação no modo de auditoria para medir o impacto potencial da compatibilidade em um aplicativo.</span><span class="sxs-lookup"><span data-stu-id="a89c2-362">**Audit Only** - You can enable this mitigation in audit mode in order to measure the potential compatibility impact on an application.</span></span> <span data-ttu-id="a89c2-363">Os eventos de auditoria podem ser exibidos no visualizador de eventos ou usando a Busca Avançada no [Microsoft Defender para Ponto de Extremidade.](https://docs.microsoft.com/microsoft-365/security/defender/advanced-hunting-overview)</span><span class="sxs-lookup"><span data-stu-id="a89c2-363">Audit events can then be viewed either in the event viewer or using Advanced Hunting in [Microsoft Defender for Endpoint](https://docs.microsoft.com/microsoft-365/security/defender/advanced-hunting-overview).</span></span>

## <a name="validate-api-invocation-callercheck"></a><span data-ttu-id="a89c2-364">Validar invocação de API (CallerCheck)</span><span class="sxs-lookup"><span data-stu-id="a89c2-364">Validate API invocation (CallerCheck)</span></span>

### <a name="description"></a><span data-ttu-id="a89c2-365">Descrição</span><span class="sxs-lookup"><span data-stu-id="a89c2-365">Description</span></span>

<span data-ttu-id="a89c2-366">Validar invocação de API (CallerCheck) é uma mitigação para técnicas rop (programação orientada a retorno) que valida que APIs confidenciais foram chamadas de um chamador válido.</span><span class="sxs-lookup"><span data-stu-id="a89c2-366">Validate API invocation (CallerCheck) is a mitigation for return-oriented programming (ROP) techniques that validates that sensitive APIs were called from a valid caller.</span></span> <span data-ttu-id="a89c2-367">Essa mitigação inspeciona o endereço de retorno passado e, em seguida, desmonta heuristicamente para trás para encontrar uma chamada acima do endereço de retorno para determinar se o destino da chamada corresponde ao parâmetro passado para a função.</span><span class="sxs-lookup"><span data-stu-id="a89c2-367">This mitigation inspects the passed return address, and then heuristically disassembles backwards to find a call above the return address to determine if the call target matches the parameter passed into the function.</span></span>

<span data-ttu-id="a89c2-368">As APIs interceptadas por essa mitigação são:</span><span class="sxs-lookup"><span data-stu-id="a89c2-368">The APIs intercepted by this mitigation are:</span></span>

- `LoadLibraryA`
- `LoadLibraryW`
- `LoadLibraryExA`
- `LoadLibraryExW`
- `LdrLoadDll`
- `VirtualAlloc`
- `VirtualAllocEx`
- `NtAllocateVirtualMemory`
- `VirtualProtect`
- `VirtualProtectEx`
- `NtProtectVirtualMemory`
- `HeapCreate`
- `RtlCreateHeap`
- `CreateProcessA`
- `CreateProcessW`
- `CreateProcessInternalA`
- `CreateProcessInternalW`
- `NtCreateUserProcess`
- `NtCreateProcess`
- `NtCreateProcessEx`
- `CreateRemoteThread`
- `CreateRemoteThreadEx`
- `NtCreateThreadEx`
- `WriteProcessMemory`
- `NtWriteVirtualMemory`
- `WinExec`
- `CreateFileMappingA`
- `CreateFileMappingW`
- `CreateFileMappingNumaW`
- `NtCreateSection`
- `MapViewOfFile`
- `MapViewOfFileEx`
- `MapViewOfFileFromApp`
- `LdrGetProcedureAddressForCaller`

<span data-ttu-id="a89c2-369">Se um gadget ROP for detectado, o processo será encerrado.</span><span class="sxs-lookup"><span data-stu-id="a89c2-369">If a ROP gadget is detected, the process is terminated.</span></span>

### <a name="compatibility-considerations"></a><span data-ttu-id="a89c2-370">Considerações sobre compatibilidade</span><span class="sxs-lookup"><span data-stu-id="a89c2-370">Compatibility considerations</span></span>

<span data-ttu-id="a89c2-371">Aplicativos que executam interceptação de API, especialmente software de segurança, podem causar problemas de compatibilidade com essa mitigação.</span><span class="sxs-lookup"><span data-stu-id="a89c2-371">Applications that perform API interception, particularly security software, can cause compatibility problems with this mitigation.</span></span>

<span data-ttu-id="a89c2-372">Essa mitigação é incompatível com a mitigação do Code Guard arbitrário.</span><span class="sxs-lookup"><span data-stu-id="a89c2-372">This mitigation is incompatible with the Arbitrary Code Guard mitigation.</span></span>

### <a name="configuration-options"></a><span data-ttu-id="a89c2-373">Opções de configuração</span><span class="sxs-lookup"><span data-stu-id="a89c2-373">Configuration options</span></span>

<span data-ttu-id="a89c2-374">**Somente auditoria** - Você pode habilitar essa mitigação no modo de auditoria para medir o impacto potencial da compatibilidade em um aplicativo.</span><span class="sxs-lookup"><span data-stu-id="a89c2-374">**Audit Only** - You can enable this mitigation in audit mode in order to measure the potential compatibility impact on an application.</span></span> <span data-ttu-id="a89c2-375">Os eventos de auditoria podem ser exibidos no visualizador de eventos ou usando a Busca Avançada no [Microsoft Defender para Ponto de Extremidade.](https://docs.microsoft.com/microsoft-365/security/defender/advanced-hunting-overview)</span><span class="sxs-lookup"><span data-stu-id="a89c2-375">Audit events can then be viewed either in the event viewer or using Advanced Hunting in [Microsoft Defender for Endpoint](https://docs.microsoft.com/microsoft-365/security/defender/advanced-hunting-overview).</span></span>

## <a name="validate-exception-chains-sehop"></a><span data-ttu-id="a89c2-376">Validar cadeias de exceção (SEHOP)</span><span class="sxs-lookup"><span data-stu-id="a89c2-376">Validate exception chains (SEHOP)</span></span>

### <a name="description"></a><span data-ttu-id="a89c2-377">Descrição</span><span class="sxs-lookup"><span data-stu-id="a89c2-377">Description</span></span>

<span data-ttu-id="a89c2-378">Validar cadeias de exceção (SEHOP) é uma mitigação em relação à técnica de exploração de sobregravações do Manipulador de Exceção *Estruturado (SEH).*</span><span class="sxs-lookup"><span data-stu-id="a89c2-378">Validate exception chains (SEHOP) is a mitigation against the *Structured Exception Handler (SEH) overwrite* exploitation technique.</span></span> <span data-ttu-id="a89c2-379">[O tratamento de exceção](https://docs.microsoft.com/windows/win32/debug/structured-exception-handling) estruturado é o processo pelo qual um aplicativo pode pedir para lidar com uma exceção específica.</span><span class="sxs-lookup"><span data-stu-id="a89c2-379">[Structured exception handling](https://docs.microsoft.com/windows/win32/debug/structured-exception-handling) is the process by which an application can ask to handle a particular exception.</span></span> <span data-ttu-id="a89c2-380">Manipuladores de exceção são encadeados juntos, para que, se um manipulador de exceção optar por não manipular uma exceção específica, ele poderá ser passado para o próximo manipulador de exceção na cadeia até que um decida lidar com ela.</span><span class="sxs-lookup"><span data-stu-id="a89c2-380">Exception handlers are chained together, so that if one exception handler chooses not to handle a particular exception, it can be passed on to the next exception handler in the chain until one decides to handle it.</span></span> <span data-ttu-id="a89c2-381">Como a lista de manipuladores é dinâmica, ela é armazenada na pilha.</span><span class="sxs-lookup"><span data-stu-id="a89c2-381">Because the list of handler is dynamic, it is stored on the stack.</span></span> <span data-ttu-id="a89c2-382">Um invasor pode usar uma vulnerabilidade de estouro de pilha para substituir o manipulador de exceção com um ponteiro para o código de escolha do invasor.</span><span class="sxs-lookup"><span data-stu-id="a89c2-382">An attacker can use a stack overflow vulnerability to then overwrite the exception handler with a pointer to the code of the attacker's choice.</span></span>

<span data-ttu-id="a89c2-383">Essa mitigação se baseia no design do SEH, onde cada entrada SEH contém um ponteiro para o manipulador de exceção, bem como um ponteiro para o próximo manipulador na cadeia de exceção.</span><span class="sxs-lookup"><span data-stu-id="a89c2-383">This mitigation relies on the design of SEH, where each SEH entry contains both a pointer to the exception handler, as well as a pointer to the next handler in the exception chain.</span></span> <span data-ttu-id="a89c2-384">Essa mitigação é chamada pelo despachante de exceção, que valida a cadeia SEH quando uma exceção é invocada.</span><span class="sxs-lookup"><span data-stu-id="a89c2-384">This mitigation is called by the exception dispatcher, which validates the SEH chain when an exception is invoked.</span></span> <span data-ttu-id="a89c2-385">Verifica se:</span><span class="sxs-lookup"><span data-stu-id="a89c2-385">It verifies that:</span></span>

- <span data-ttu-id="a89c2-386">Todos os registros de cadeia de exceção estão dentro dos limites da pilha</span><span class="sxs-lookup"><span data-stu-id="a89c2-386">All exception chain records are within the stack boundaries</span></span>
- <span data-ttu-id="a89c2-387">Todos os registros de exceção são alinhados</span><span class="sxs-lookup"><span data-stu-id="a89c2-387">All exception records are aligned</span></span>
- <span data-ttu-id="a89c2-388">Nenhum ponteiro do manipulador de exceção está apontando para a pilha</span><span class="sxs-lookup"><span data-stu-id="a89c2-388">No exception handler pointers are pointing to the stack</span></span>
- <span data-ttu-id="a89c2-389">Não há ponteiros para trás</span><span class="sxs-lookup"><span data-stu-id="a89c2-389">There are no backward pointers</span></span>
- <span data-ttu-id="a89c2-390">A cadeia de exceção termina em um manipulador de exceção final conhecido</span><span class="sxs-lookup"><span data-stu-id="a89c2-390">The exception chain ends at a known final exception handler</span></span>

<span data-ttu-id="a89c2-391">Se essas validações falharem, o tratamento de exceções será anulado e a exceção não será manipulada.</span><span class="sxs-lookup"><span data-stu-id="a89c2-391">If these validations fail, then exception handling is aborted, and the exception will not be handled.</span></span>

### <a name="compatibility-considerations"></a><span data-ttu-id="a89c2-392">Considerações sobre compatibilidade</span><span class="sxs-lookup"><span data-stu-id="a89c2-392">Compatibility considerations</span></span>

<span data-ttu-id="a89c2-393">Os problemas de compatibilidade com o SEHOP são relativamente raros.</span><span class="sxs-lookup"><span data-stu-id="a89c2-393">Compatibility issues with SEHOP are relatively rare.</span></span> <span data-ttu-id="a89c2-394">É incomum para um aplicativo assumir uma dependência de corromper a cadeia de exceção.</span><span class="sxs-lookup"><span data-stu-id="a89c2-394">It's uncommon for an application to take a dependency on corrupting the exception chain.</span></span> <span data-ttu-id="a89c2-395">No entanto, alguns aplicativos são afetados pelas alterações sutis no tempo, que podem se manifesto como uma condição de corrida que revela um bug latente de vários threads no aplicativo.</span><span class="sxs-lookup"><span data-stu-id="a89c2-395">However, some applications are impacted by the subtle changes in timing, which may manifest as a race condition that reveals a latent multi-threading bug in the application.</span></span>

### <a name="configuration-options"></a><span data-ttu-id="a89c2-396">Opções de configuração</span><span class="sxs-lookup"><span data-stu-id="a89c2-396">Configuration options</span></span>

> [!Note]
> <span data-ttu-id="a89c2-397">**Validar cadeias de exceção (SEHOP)** não tem modo de auditoria.</span><span class="sxs-lookup"><span data-stu-id="a89c2-397">**Validate exception chains (SEHOP)** has no audit mode.</span></span>

## <a name="validate-handle-usage"></a><span data-ttu-id="a89c2-398">Validar o uso da alça</span><span class="sxs-lookup"><span data-stu-id="a89c2-398">Validate handle usage</span></span>

### <a name="description"></a><span data-ttu-id="a89c2-399">Descrição</span><span class="sxs-lookup"><span data-stu-id="a89c2-399">Description</span></span>

<span data-ttu-id="a89c2-400">*Validar o uso do* identificador é uma mitigação que ajuda a proteger contra um invasor usando uma alça existente para acessar um objeto protegido.</span><span class="sxs-lookup"><span data-stu-id="a89c2-400">*Validate handle usage* is a mitigation that helps protect against an attacker using an existing handle to access a protected object.</span></span> <span data-ttu-id="a89c2-401">Um [identificador](https://docs.microsoft.com/windows/win32/sysinfo/handles-and-objects) é uma referência a um objeto protegido.</span><span class="sxs-lookup"><span data-stu-id="a89c2-401">A [handle](https://docs.microsoft.com/windows/win32/sysinfo/handles-and-objects) is a reference to a protected object.</span></span> <span data-ttu-id="a89c2-402">Se o código do aplicativo estiver fazendo referência a uma alça inválida, isso pode indicar que um adversário está tentando usar uma alça que ele gravou anteriormente (mas qual contagem de referência de aplicativo não estaria ciente).</span><span class="sxs-lookup"><span data-stu-id="a89c2-402">If application code is referencing an invalid handle, that could indicate that an adversary is attempting to use a handle it has previously recorded (but which application reference counting wouldn't be aware of).</span></span> <span data-ttu-id="a89c2-403">Se o aplicativo tentar usar um objeto inválido, em vez de simplesmente retornar null, o aplicativo criará uma exceção (STATUS_INVALID_HANDLE).</span><span class="sxs-lookup"><span data-stu-id="a89c2-403">If the application attempts to use an invalid object, instead of simply returning null, the application will raise an exception (STATUS_INVALID_HANDLE).</span></span>

<span data-ttu-id="a89c2-404">Essa mitigação é aplicada automaticamente aos aplicativos da Windows Store.</span><span class="sxs-lookup"><span data-stu-id="a89c2-404">This mitigation is automatically applied to Windows Store applications.</span></span>

### <a name="compatibility-considerations"></a><span data-ttu-id="a89c2-405">Considerações sobre compatibilidade</span><span class="sxs-lookup"><span data-stu-id="a89c2-405">Compatibility considerations</span></span>

<span data-ttu-id="a89c2-406">Os aplicativos que não estavam monitorando com precisão as referências de alça e que não estavam envolvendo essas operações em manipuladores de exceção, serão potencialmente afetados por essa mitigação.</span><span class="sxs-lookup"><span data-stu-id="a89c2-406">Applications that were not accurately tracking handle references, and which were not wrapping these operations in exception handlers, will potentially be impacted by this mitigation.</span></span>

### <a name="configuration-options"></a><span data-ttu-id="a89c2-407">Opções de configuração</span><span class="sxs-lookup"><span data-stu-id="a89c2-407">Configuration options</span></span>

> [!Note]
> <span data-ttu-id="a89c2-408">**Validar o uso de alça** não tem modo de auditoria.</span><span class="sxs-lookup"><span data-stu-id="a89c2-408">**Validate handle usage** has no audit mode.</span></span>

## <a name="validate-heap-integrity"></a><span data-ttu-id="a89c2-409">Validar a integridade da pilha</span><span class="sxs-lookup"><span data-stu-id="a89c2-409">Validate heap integrity</span></span>

### <a name="description"></a><span data-ttu-id="a89c2-410">Descrição</span><span class="sxs-lookup"><span data-stu-id="a89c2-410">Description</span></span>

<span data-ttu-id="a89c2-411">A *mitigação de integridade de* pilha de validação aumenta o nível de proteção de mitigações de pilha no Windows, fazendo com que o aplicativo seja encerrado se uma corrupção de pilha for detectada.</span><span class="sxs-lookup"><span data-stu-id="a89c2-411">The *validate heap integrity* mitigation increases the protection level of heap mitigations in Windows, by causing the application to terminate if a heap corruption is detected.</span></span> <span data-ttu-id="a89c2-412">As mitigações incluem:</span><span class="sxs-lookup"><span data-stu-id="a89c2-412">The mitigations include:</span></span>

- <span data-ttu-id="a89c2-413">Impedindo que uma alça HEAP seja liberada</span><span class="sxs-lookup"><span data-stu-id="a89c2-413">Preventing a HEAP handle from being freed</span></span>
- <span data-ttu-id="a89c2-414">Executando outra validação em headers de bloco estendido para alocações de pilha</span><span class="sxs-lookup"><span data-stu-id="a89c2-414">Performing another validation on extended block headers for heap allocations</span></span>
- <span data-ttu-id="a89c2-415">Verificar se as alocações de pilha já não estão sinalizadas como em uso</span><span class="sxs-lookup"><span data-stu-id="a89c2-415">Verifying that heap allocations are not already flagged as in-use</span></span>
- <span data-ttu-id="a89c2-416">Adicionar páginas de proteção a grandes alocações, segmentos de heap e subsegments acima de um tamanho mínimo</span><span class="sxs-lookup"><span data-stu-id="a89c2-416">Adding guard pages to large allocations, heap segments, and subsegments above a minimum size</span></span>

### <a name="compatibility-considerations"></a><span data-ttu-id="a89c2-417">Considerações sobre compatibilidade</span><span class="sxs-lookup"><span data-stu-id="a89c2-417">Compatibility considerations</span></span>

<span data-ttu-id="a89c2-418">Essa mitigação já é aplicada por padrão para aplicativos de 64 bits e para aplicativos de 32 bits destinados ao Windows Vista ou posterior.</span><span class="sxs-lookup"><span data-stu-id="a89c2-418">This mitigation is already applied by default for 64-bit applications and for 32-bit applications targeting Windows Vista or later.</span></span> <span data-ttu-id="a89c2-419">Aplicativos herdáveis do Windows XP ou anteriores são mais em risco, embora os problemas de compatibilidade sejam raros.</span><span class="sxs-lookup"><span data-stu-id="a89c2-419">Legacy applications from Windows XP or earlier are most at-risk, though compatibility issues are rare.</span></span>

### <a name="configuration-options"></a><span data-ttu-id="a89c2-420">Opções de configuração</span><span class="sxs-lookup"><span data-stu-id="a89c2-420">Configuration options</span></span>

> [!Note]
> <span data-ttu-id="a89c2-421">**Validar integridade de pilha** não tem modo de auditoria.</span><span class="sxs-lookup"><span data-stu-id="a89c2-421">**Validate heap integrity** has no audit mode.</span></span>

## <a name="validate-image-dependency-integrity"></a><span data-ttu-id="a89c2-422">Validar a integridade da dependência de imagem</span><span class="sxs-lookup"><span data-stu-id="a89c2-422">Validate image dependency integrity</span></span>

### <a name="description"></a><span data-ttu-id="a89c2-423">Descrição</span><span class="sxs-lookup"><span data-stu-id="a89c2-423">Description</span></span>

<span data-ttu-id="a89c2-424">A *mitigação de dependência de imagem* valida ajuda a proteger contra ataques que tentam substituir o código para dlls que são vinculados estaticamente por binários do Windows.</span><span class="sxs-lookup"><span data-stu-id="a89c2-424">The *validate image dependency* mitigation helps protect against attacks that attempt to substitute code for dlls that are statically linked by Windows binaries.</span></span> <span data-ttu-id="a89c2-425">A técnica de implantação de DLL abusa do mecanismo de pesquisa do carregador para injetar código mal-intencionado, que pode ser usado para obter código mal-intencionado em execução em um contexto elevado.</span><span class="sxs-lookup"><span data-stu-id="a89c2-425">The technique of DLL planting abuses the loader's search mechanism to inject malicious code, which can be used to get malicious code running in an elevated context.</span></span> <span data-ttu-id="a89c2-426">Quando o carregador estiver carregando um binário assinado pelo Windows e carregar todas as dlls das que o binário depende, esses binários serão verificados para garantir que eles também sejam assinados digitalmente como um binário do Windows.</span><span class="sxs-lookup"><span data-stu-id="a89c2-426">When the loader is loading a Windows signed binary, and then loads up any dlls that the binary depends on, these binaries will be verified to ensure that they are also digitally signed as a Windows binary.</span></span> <span data-ttu-id="a89c2-427">Se eles falharem na verificação de assinatura, a dll não será carregada e lançará uma exceção, retornando um status de STATUS_INVALID_IMAGE_HASH.</span><span class="sxs-lookup"><span data-stu-id="a89c2-427">If they fail the signature check, the dll will not be loaded, and will throw an exception, returning a status of STATUS_INVALID_IMAGE_HASH.</span></span>

### <a name="compatibility-considerations"></a><span data-ttu-id="a89c2-428">Considerações sobre compatibilidade</span><span class="sxs-lookup"><span data-stu-id="a89c2-428">Compatibility considerations</span></span>

<span data-ttu-id="a89c2-429">Os problemas de compatibilidade são incomuns.</span><span class="sxs-lookup"><span data-stu-id="a89c2-429">Compatibility issues are uncommon.</span></span> <span data-ttu-id="a89c2-430">Os aplicativos que dependem da substituição de binários do Windows por versões privadas locais serão afetados e também há um pequeno risco de revelar bugs de tempo sutis em aplicativos com vários threads.</span><span class="sxs-lookup"><span data-stu-id="a89c2-430">Applications that depend on replacing Windows binaries with local private versions will be impacted, and there is also a small risk of revealing subtle timing bugs in multi-threaded applications.</span></span>

### <a name="configuration-options"></a><span data-ttu-id="a89c2-431">Opções de configuração</span><span class="sxs-lookup"><span data-stu-id="a89c2-431">Configuration options</span></span>

<span data-ttu-id="a89c2-432">**Somente auditoria** - Você pode habilitar essa mitigação no modo de auditoria para medir o impacto potencial da compatibilidade em um aplicativo.</span><span class="sxs-lookup"><span data-stu-id="a89c2-432">**Audit Only** - You can enable this mitigation in audit mode in order to measure the potential compatibility impact on an application.</span></span> <span data-ttu-id="a89c2-433">Os eventos de auditoria podem ser exibidos no visualizador de eventos ou usando a Busca Avançada no [Microsoft Defender para Ponto de Extremidade.](https://docs.microsoft.com/microsoft-365/security/defender/advanced-hunting-overview)</span><span class="sxs-lookup"><span data-stu-id="a89c2-433">Audit events can then be viewed either in the event viewer or using Advanced Hunting in [Microsoft Defender for Endpoint](https://docs.microsoft.com/microsoft-365/security/defender/advanced-hunting-overview).</span></span>

## <a name="validate-stack-integrity-stackpivot"></a><span data-ttu-id="a89c2-434">Validar a integridade da pilha (StackPivot)</span><span class="sxs-lookup"><span data-stu-id="a89c2-434">Validate stack integrity (StackPivot)</span></span>

### <a name="description"></a><span data-ttu-id="a89c2-435">Descrição</span><span class="sxs-lookup"><span data-stu-id="a89c2-435">Description</span></span>

<span data-ttu-id="a89c2-436">A mitigação validar a integridade da pilha *(StackPivot)* ajuda a proteger contra o ataque Pivot de Pilha, um ataque ROP em que um invasor cria uma pilha falsa na memória de pilha e, em seguida, faz o aplicativo voltar para a pilha falsa que controla o fluxo de execução.</span><span class="sxs-lookup"><span data-stu-id="a89c2-436">The *validate stack integrity (StackPivot)* mitigation helps protect against the Stack Pivot attack, a ROP attack where an attacker creates a fake stack in heap memory, and then tricks the application into returning into the fake stack that controls the flow of execution.</span></span>

<span data-ttu-id="a89c2-437">Essa mitigação intercepta muitas APIs do Windows e inspeciona o valor do ponteiro da pilha.</span><span class="sxs-lookup"><span data-stu-id="a89c2-437">This mitigation intercepts many Windows APIs, and inspects the value of the stack pointer.</span></span> <span data-ttu-id="a89c2-438">Se o endereço do ponteiro da pilha não se enquadrar entre a parte inferior e a parte superior da pilha, um evento será gravado e, se não estiver no modo de auditoria, o processo será encerrado.</span><span class="sxs-lookup"><span data-stu-id="a89c2-438">If the address of the stack pointer does not fall between the bottom and the top of the stack, then an event is recorded and, if not in audit mode, the process will be terminated.</span></span>

<span data-ttu-id="a89c2-439">As APIs interceptadas por essa mitigação são:</span><span class="sxs-lookup"><span data-stu-id="a89c2-439">The APIs intercepted by this mitigation are:</span></span>

- `LoadLibraryA`
- `LoadLibraryW`
- `LoadLibraryExA`
- `LoadLibraryExW`
- `LdrLoadDll`
- `VirtualAlloc`
- `VirtualAllocEx`
- `NtAllocateVirtualMemory`
- `VirtualProtect`
- `VirtualProtectEx`
- `NtProtectVirtualMemory`
- `HeapCreate`
- `RtlCreateHeap`
- `CreateProcessA`
- `CreateProcessW`
- `CreateProcessInternalA`
- `CreateProcessInternalW`
- `NtCreateUserProcess`
- `NtCreateProcess`
- `NtCreateProcessEx`
- `CreateRemoteThread`
- `CreateRemoteThreadEx`
- `NtCreateThreadEx`
- `WriteProcessMemory`
- `NtWriteVirtualMemory`
- `WinExec`
- `CreateFileMappingA`
- `CreateFileMappingW`
- `CreateFileMappingNumaW`
- `NtCreateSection`
- `MapViewOfFile`
- `MapViewOfFileEx`
- `MapViewOfFileFromApp`
- `LdrGetProcedureAddressForCaller`

### <a name="compatibility-considerations"></a><span data-ttu-id="a89c2-440">Considerações sobre compatibilidade</span><span class="sxs-lookup"><span data-stu-id="a89c2-440">Compatibility considerations</span></span>

<span data-ttu-id="a89c2-441">Os aplicativos que estão usando pilhas falsas serão afetados e também há um pequeno risco de revelar bugs de tempo sutis em aplicativos com vários threads.</span><span class="sxs-lookup"><span data-stu-id="a89c2-441">Applications that are using fake stacks will be impacted, and there is also a small risk of revealing subtle timing bugs in multi-threaded applications.</span></span>
<span data-ttu-id="a89c2-442">Aplicativos que executam interceptação de API, especialmente software de segurança, podem causar problemas de compatibilidade com essa mitigação.</span><span class="sxs-lookup"><span data-stu-id="a89c2-442">Applications that perform API interception, particularly security software, can cause compatibility problems with this mitigation.</span></span>

<span data-ttu-id="a89c2-443">Essa mitigação é incompatível com a mitigação do Code Guard arbitrário.</span><span class="sxs-lookup"><span data-stu-id="a89c2-443">This mitigation is incompatible with the Arbitrary Code Guard mitigation.</span></span>

### <a name="configuration-options"></a><span data-ttu-id="a89c2-444">Opções de configuração</span><span class="sxs-lookup"><span data-stu-id="a89c2-444">Configuration options</span></span>

<span data-ttu-id="a89c2-445">**Somente auditoria** - Você pode habilitar essa mitigação no modo de auditoria para medir o impacto potencial da compatibilidade em um aplicativo.</span><span class="sxs-lookup"><span data-stu-id="a89c2-445">**Audit Only** - You can enable this mitigation in audit mode in order to measure the potential compatibility impact on an application.</span></span> <span data-ttu-id="a89c2-446">Os eventos de auditoria podem ser exibidos no visualizador de eventos ou usando a Busca Avançada no [Microsoft Defender para Ponto de Extremidade.](https://docs.microsoft.com/microsoft-365/security/defender/advanced-hunting-overview)</span><span class="sxs-lookup"><span data-stu-id="a89c2-446">Audit events can then be viewed either in the event viewer or using Advanced Hunting in [Microsoft Defender for Endpoint](https://docs.microsoft.com/microsoft-365/security/defender/advanced-hunting-overview).</span></span>
